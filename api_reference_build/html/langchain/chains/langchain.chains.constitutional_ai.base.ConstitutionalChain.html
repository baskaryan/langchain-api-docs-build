
<!DOCTYPE html>

<html data-content_root="" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.19: https://docutils.sourceforge.io/" name="generator"/>
<title>ConstitutionalChain â€” ðŸ¦œðŸ”— LangChain  documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/autodoc_pydantic.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/css/custom.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/doctools.js"></script>
<script src="../../_static/sphinx_highlight.js"></script>
<script src="../../_static/clipboard.min.js"></script>
<script src="../../_static/copybutton.js"></script>
<script src="../../_static/design-tabs.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'langchain/chains/langchain.chains.constitutional_ai.base.ConstitutionalChain';</script>
<link href="../../_static/favicon.png" rel="icon"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="langchain.chains.conversation.base.ConversationChain.html" rel="next" title="ConversationChain"/>
<link href="langchain.chains.combine_documents.stuff.StuffDocumentsChain.html" rel="prev" title="StuffDocumentsChain"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<meta content="Aug 26, 2024" name="docbuild:last-update"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<input class="sidebar-toggle" id="pst-primary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
<input class="sidebar-toggle" id="pst-secondary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search" spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
<button aria-label="Site navigation" class="pst-navbar-icon sidebar-toggle primary-toggle">
<span class="fa-solid fa-bars"></span>
</button>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../../index.html">
<img alt="ðŸ¦œðŸ”— LangChain  documentation - Home" class="logo__image only-light" src="../../_static/wordmark-api.svg"/>
<script>document.write(`<img src="../../_static/wordmark-api-dark.svg" class="logo__image only-dark" alt="ðŸ¦œðŸ”— LangChain  documentation - Home"/>`);</script>
</a></div>
</div>
<div class="navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item">
<nav>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../../reference.html">
    Reference
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-external" href="https://api.python.langchain.com/">
    Legacy reference
  </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search" spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
<div class="navbar-item"><!-- This will display a link to LangChain docs -->
<head>
<style>
        .text-link {
            text-decoration: none; /* Remove underline */
            color: inherit;        /* Inherit color from parent element */
        }
    </style>
</head>
<body>
<a class="text-link" href="https://python.langchain.com/">Docs</a>
</body></div>
<div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
<div class="navbar-item"><ul aria-label="Quick Links" class="navbar-icon-links">
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/langchain-ai/langchain" rel="noopener" target="_blank" title="GitHub"><i aria-hidden="true" class="fa-brands fa-square-github fa-lg"></i>
<span class="sr-only">GitHub</span></a>
</li>
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://twitter.com/langchainai" rel="noopener" target="_blank" title="X / Twitter"><i aria-hidden="true" class="fab fa-twitter-square fa-lg"></i>
<span class="sr-only">X / Twitter</span></a>
</li>
</ul></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search" spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
<button aria-label="On this page" class="pst-navbar-icon sidebar-toggle secondary-toggle">
<span class="fa-solid fa-outdent"></span>
</button>
</div>
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item">
<nav>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../../reference.html">
    Reference
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-external" href="https://api.python.langchain.com/">
    Legacy reference
  </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item"><!-- This will display a link to LangChain docs -->
<head>
<style>
        .text-link {
            text-decoration: none; /* Remove underline */
            color: inherit;        /* Inherit color from parent element */
        }
    </style>
</head>
<body>
<a class="text-link" href="https://python.langchain.com/">Docs</a>
</body></div>
<div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
<div class="navbar-item"><ul aria-label="Quick Links" class="navbar-icon-links">
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/langchain-ai/langchain" rel="noopener" target="_blank" title="GitHub"><i aria-hidden="true" class="fa-brands fa-square-github fa-lg"></i>
<span class="sr-only">GitHub</span></a>
</li>
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://twitter.com/langchainai" rel="noopener" target="_blank" title="X / Twitter"><i aria-hidden="true" class="fab fa-twitter-square fa-lg"></i>
<span class="sr-only">X / Twitter</span></a>
</li>
</ul></div>
</div>
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
<p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
<div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Base packages</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../core/index.html">Core</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Langchain</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../agents.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../callbacks.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">callbacks</span></code></a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../chains.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chains</span></code></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.base.Chain.html">Chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.base.BaseCombineDocumentsChain.html">BaseCombineDocumentsChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.map_reduce.MapReduceDocumentsChain.html">MapReduceDocumentsChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.map_rerank.MapRerankDocumentsChain.html">MapRerankDocumentsChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.reduce.AsyncCombineDocsProtocol.html">AsyncCombineDocsProtocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.reduce.CombineDocsProtocol.html">CombineDocsProtocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.reduce.ReduceDocumentsChain.html">ReduceDocumentsChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.refine.RefineDocumentsChain.html">RefineDocumentsChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple.html">ConstitutionalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.conversational_retrieval.base.BaseConversationalRetrievalChain.html">BaseConversationalRetrievalChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.conversational_retrieval.base.ChatVectorDBChain.html">ChatVectorDBChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.conversational_retrieval.base.InputType.html">InputType</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.elasticsearch_database.base.ElasticsearchDatabaseChain.html">ElasticsearchDatabaseChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.flare.base.FlareChain.html">FlareChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.flare.base.QuestionGeneratorChain.html">QuestionGeneratorChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.flare.prompts.FinishedOutputParser.html">FinishedOutputParser</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.hyde.base.HypotheticalDocumentEmbedder.html">HypotheticalDocumentEmbedder</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.moderation.OpenAIModerationChain.html">OpenAIModerationChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.natbot.crawler.Crawler.html">Crawler</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.natbot.crawler.ElementInViewPort.html">ElementInViewPort</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.citation_fuzzy_match.FactWithEvidence.html">FactWithEvidence</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.citation_fuzzy_match.QuestionAnswer.html">QuestionAnswer</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.openapi.SimpleRequestChain.html">SimpleRequestChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.qa_with_structure.AnswerWithSources.html">AnswerWithSources</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.prompt_selector.BasePromptSelector.html">BasePromptSelector</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.prompt_selector.ConditionalPromptSelector.html">ConditionalPromptSelector</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_with_sources.loading.LoadingCallable.html">LoadingCallable</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_with_sources.retrieval.RetrievalQAWithSourcesChain.html">RetrievalQAWithSourcesChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_with_sources.vector_db.VectorDBQAWithSourcesChain.html">VectorDBQAWithSourcesChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.base.StructuredQueryOutputParser.html">StructuredQueryOutputParser</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.parser.ISO8601Date.html">ISO8601Date</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.schema.AttributeInfo.html">AttributeInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.question_answering.chain.LoadingCallable.html">LoadingCallable</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.base.MultiRouteChain.html">MultiRouteChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.base.Route.html">Route</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.base.RouterChain.html">RouterChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.embedding_router.EmbeddingRouterChain.html">EmbeddingRouterChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.llm_router.RouterOutputParser.html">RouterOutputParser</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.multi_retrieval_qa.MultiRetrievalQAChain.html">MultiRetrievalQAChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.sequential.SequentialChain.html">SequentialChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.sequential.SimpleSequentialChain.html">SimpleSequentialChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.sql_database.query.SQLInput.html">SQLInput</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.sql_database.query.SQLInputWithTables.html">SQLInputWithTables</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.summarize.chain.LoadingCallable.html">LoadingCallable</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.transform.TransformChain.html">TransformChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.reduce.acollapse_docs.html">acollapse_docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.reduce.collapse_docs.html">collapse_docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.reduce.split_list_of_docs.html">split_list_of_docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.stuff.create_stuff_documents_chain.html">create_stuff_documents_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.example_generator.generate_example.html">generate_example</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.history_aware_retriever.create_history_aware_retriever.html">create_history_aware_retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.citation_fuzzy_match.create_citation_fuzzy_match_runnable.html">create_citation_fuzzy_match_runnable</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.openapi.openapi_spec_to_openai_fn.html">openapi_spec_to_openai_fn</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.utils.get_llm_kwargs.html">get_llm_kwargs</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.prompt_selector.is_chat_model.html">is_chat_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.prompt_selector.is_llm.html">is_llm</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.base.construct_examples.html">construct_examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.base.fix_filter_directive.html">fix_filter_directive</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.base.get_query_constructor_prompt.html">get_query_constructor_prompt</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.base.load_query_constructor_runnable.html">load_query_constructor_runnable</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.parser.get_parser.html">get_parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.parser.v_args.html">v_args</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.retrieval.create_retrieval_chain.html">create_retrieval_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.sql_database.query.create_sql_query_chain.html">create_sql_query_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.structured_output.base.get_openai_output_parser.html">get_openai_output_parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.summarize.chain.load_summarize_chain.html">load_summarize_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.api.base.APIChain.html">APIChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.base.AnalyzeDocumentChain.html">AnalyzeDocumentChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.combine_documents.stuff.StuffDocumentsChain.html">StuffDocumentsChain</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">ConstitutionalChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.conversation.base.ConversationChain.html">ConversationChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.conversational_retrieval.base.ConversationalRetrievalChain.html">ConversationalRetrievalChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.llm.LLMChain.html">LLMChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.llm_checker.base.LLMCheckerChain.html">LLMCheckerChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.llm_math.base.LLMMathChain.html">LLMMathChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.llm_summarization_checker.base.LLMSummarizationCheckerChain.html">LLMSummarizationCheckerChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.mapreduce.MapReduceChain.html">MapReduceChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.natbot.base.NatBotChain.html">NatBotChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_generation.base.QAGenerationChain.html">QAGenerationChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_with_sources.base.BaseQAWithSourcesChain.html">BaseQAWithSourcesChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_with_sources.base.QAWithSourcesChain.html">QAWithSourcesChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.retrieval_qa.base.BaseRetrievalQA.html">BaseRetrievalQA</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.retrieval_qa.base.RetrievalQA.html">RetrievalQA</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.retrieval_qa.base.VectorDBQA.html">VectorDBQA</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.llm_router.LLMRouterChain.html">LLMRouterChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.router.multi_prompt.MultiPromptChain.html">MultiPromptChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.loading.load_chain.html">load_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.loading.load_chain_from_config.html">load_chain_from_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.base.create_openai_fn_chain.html">create_openai_fn_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.base.create_structured_output_chain.html">create_structured_output_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.citation_fuzzy_match.create_citation_fuzzy_match_chain.html">create_citation_fuzzy_match_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.extraction.create_extraction_chain.html">create_extraction_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.extraction.create_extraction_chain_pydantic.html">create_extraction_chain_pydantic</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.openapi.get_openapi_chain.html">get_openapi_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.qa_with_structure.create_qa_with_sources_chain.html">create_qa_with_sources_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.qa_with_structure.create_qa_with_structure_chain.html">create_qa_with_structure_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.tagging.create_tagging_chain.html">create_tagging_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_functions.tagging.create_tagging_chain_pydantic.html">create_tagging_chain_pydantic</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.openai_tools.extraction.create_extraction_chain_pydantic.html">create_extraction_chain_pydantic</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.qa_with_sources.loading.load_qa_with_sources_chain.html">load_qa_with_sources_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.query_constructor.base.load_query_constructor_chain.html">load_query_constructor_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.question_answering.chain.load_qa_chain.html">load_qa_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.structured_output.base.create_openai_fn_runnable.html">create_openai_fn_runnable</a></li>
<li class="toctree-l3"><a class="reference internal" href="langchain.chains.structured_output.base.create_structured_output_runnable.html">create_structured_output_runnable</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../chat_models.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chat_models</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../embeddings.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">embeddings</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">evaluation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globals.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">globals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../hub.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hub</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../indexes.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">indexes</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">memory</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../model_laboratory.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">model_laboratory</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../output_parsers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">output_parsers</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../retrievers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">retrievers</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../runnables.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">runnables</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../smith.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">smith</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">storage</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../text_splitters/index.html">Text Splitters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../experimental/index.html">Experimental</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Integrations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ai21/index.html">AI21</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../airbyte/index.html">Airbyte</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../anthropic/index.html">Anthropic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../astradb/index.html">AstraDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aws/index.html">AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure_dynamic_sessions/index.html">Azure Dynamic Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../box/index.html">Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chroma/index.html">Chroma</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cohere/index.html">Cohere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../couchbase/index.html">Couchbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../databricks/index.html">Databricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../elasticsearch/index.html">Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exa/index.html">Exa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fireworks/index.html">Fireworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../google_community/index.html">Google Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../google_genai/index.html">Google GenAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../google_vertexai/index.html">Google VertexAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../groq/index.html">Groq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../huggingface/index.html">Huggingface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../milvus/index.html">Milvus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mistralai/index.html">MistralAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mongodb/index.html">MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nomic/index.html">Nomic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nvidia_ai_endpoints/index.html">Nvidia Ai Endpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ollama/index.html">Ollama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openai/index.html">OpenAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pinecone/index.html">Pinecone</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../postgres/index.html">Postgres</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prompty/index.html">Prompty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qdrant/index.html">Qdrant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robocorp/index.html">Robocorp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../together/index.html">Together</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unstructured/index.html">Unstructured</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../voyageai/index.html">VoyageAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../weaviate/index.html">Weaviate</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumb" class="d-print-none">
<ul class="bd-breadcrumbs">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="../../reference.html">LangChain Python API Reference</a></li>
<li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
<li class="breadcrumb-item"><a class="nav-link" href="../chains.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">chains</span></code></a></li>
<li aria-current="page" class="breadcrumb-item active">ConstitutionalChain</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<section id="constitutionalchain">
<h1>ConstitutionalChain<a class="headerlink" href="#constitutionalchain" title="Permalink to this heading">#</a></h1>
<dl class="py class pydantic_model">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">langchain.chains.constitutional_ai.base.</span></span><span class="sig-name descname"><span class="pre">ConstitutionalChain</span></span><a class="reference internal" href="../../_modules/langchain/chains/constitutional_ai/base.html#ConstitutionalChain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="langchain.chains.base.Chain.html#langchain.chains.base.Chain" title="langchain.chains.base.Chain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chain</span></code></a></p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.2.13: </span>This class is deprecated and will be removed in langchain 1.0. See API reference for replacement: <a class="reference external" href="https://api.python.langchain.com/en/latest/chains/langchain.chains.constitutional_ai.base.ConstitutionalChain.html">https://api.python.langchain.com/en/latest/chains/langchain.chains.constitutional_ai.base.ConstitutionalChain.html</a></p>
</div>
<p>Chain for applying constitutional principles.</p>
<dl>
<dt>Note: this class is deprecated. See below for a replacement implementation</dt><dd><p>using LangGraph. The benefits of this implementation are:</p>
<ul class="simple">
<li><p>Uses LLM tool calling features instead of parsing string responses;</p></li>
<li><p>Support for both token-by-token and step-by-step streaming;</p></li>
<li><p>Support for checkpointing and memory of chat history;</p></li>
<li><p>Easier to modify or extend (e.g., with additional tools, structured responses, etc.)</p></li>
</ul>
<p>Install LangGraph with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>langgraph
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">from</span> <span class="nn">langchain.chains.constitutional_ai.prompts</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CRITIQUE_PROMPT</span><span class="p">,</span>
    <span class="n">REVISION_PROMPT</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">langchain.chains.constitutional_ai.models</span> <span class="kn">import</span> <span class="n">ConstitutionalPrinciple</span>
<span class="kn">from</span> <span class="nn">langchain_core.output_parsers</span> <span class="kn">import</span> <span class="n">StrOutputParser</span>
<span class="kn">from</span> <span class="nn">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">ChatPromptTemplate</span>
<span class="kn">from</span> <span class="nn">langchain_openai</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>
<span class="kn">from</span> <span class="nn">langgraph.graph</span> <span class="kn">import</span> <span class="n">END</span><span class="p">,</span> <span class="n">START</span><span class="p">,</span> <span class="n">StateGraph</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span><span class="p">,</span> <span class="n">TypedDict</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">"gpt-4o-mini"</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Critique</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a critique, if needed."""</span>
    <span class="n">critique_needed</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">"Whether or not a critique is needed."</span><span class="p">]</span>
    <span class="n">critique</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">"If needed, the critique."</span><span class="p">]</span>

<span class="n">critique_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span>
    <span class="s2">"Critique this response according to the critique request. "</span>
    <span class="s2">"If no critique is needed, specify that.</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Query: </span><span class="si">{query}</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Response: </span><span class="si">{response}</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Critique request: </span><span class="si">{critique_request}</span><span class="s2">"</span>
<span class="p">)</span>

<span class="n">revision_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span>
    <span class="s2">"Revise this response according to the critique and reivsion request.</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Query: </span><span class="si">{query}</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Response: </span><span class="si">{response}</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Critique request: </span><span class="si">{critique_request}</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Critique: </span><span class="si">{critique}</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"If the critique does not identify anything worth changing, ignore the "</span>
    <span class="s2">"revision request and return 'No revisions needed'. If the critique "</span>
    <span class="s2">"does identify something worth changing, revise the response based on "</span>
    <span class="s2">"the revision request.</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="s2">"Revision Request: </span><span class="si">{revision_request}</span><span class="s2">"</span>
<span class="p">)</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">llm</span> <span class="o">|</span> <span class="n">StrOutputParser</span><span class="p">()</span>
<span class="n">critique_chain</span> <span class="o">=</span> <span class="n">critique_prompt</span> <span class="o">|</span> <span class="n">llm</span><span class="o">.</span><span class="n">with_structured_output</span><span class="p">(</span><span class="n">Critique</span><span class="p">)</span>
<span class="n">revision_chain</span> <span class="o">=</span> <span class="n">revision_prompt</span> <span class="o">|</span> <span class="n">llm</span> <span class="o">|</span> <span class="n">StrOutputParser</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">State</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">constitutional_principles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ConstitutionalPrinciple</span><span class="p">]</span>
    <span class="n">initial_response</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">critiques_and_revisions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="n">response</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">generate_response</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate initial response."""</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">ainvoke</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">"query"</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"response"</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span> <span class="s2">"initial_response"</span><span class="p">:</span> <span class="n">response</span><span class="p">}</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">critique_and_revise</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Critique and revise response according to principles."""</span>
    <span class="n">critiques_and_revisions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="s2">"initial_response"</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">principle</span> <span class="ow">in</span> <span class="n">state</span><span class="p">[</span><span class="s2">"constitutional_principles"</span><span class="p">]:</span>
        <span class="n">critique</span> <span class="o">=</span> <span class="k">await</span> <span class="n">critique_chain</span><span class="o">.</span><span class="n">ainvoke</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">"query"</span><span class="p">:</span> <span class="n">state</span><span class="p">[</span><span class="s2">"query"</span><span class="p">],</span>
                <span class="s2">"response"</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span>
                <span class="s2">"critique_request"</span><span class="p">:</span> <span class="n">principle</span><span class="o">.</span><span class="n">critique_request</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">critique</span><span class="p">[</span><span class="s2">"critique_needed"</span><span class="p">]:</span>
            <span class="n">revision</span> <span class="o">=</span> <span class="k">await</span> <span class="n">revision_chain</span><span class="o">.</span><span class="n">ainvoke</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">"query"</span><span class="p">:</span> <span class="n">state</span><span class="p">[</span><span class="s2">"query"</span><span class="p">],</span>
                    <span class="s2">"response"</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span>
                    <span class="s2">"critique_request"</span><span class="p">:</span> <span class="n">principle</span><span class="o">.</span><span class="n">critique_request</span><span class="p">,</span>
                    <span class="s2">"critique"</span><span class="p">:</span> <span class="n">critique</span><span class="p">[</span><span class="s2">"critique"</span><span class="p">],</span>
                    <span class="s2">"revision_request"</span><span class="p">:</span> <span class="n">principle</span><span class="o">.</span><span class="n">revision_request</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">revision</span>
            <span class="n">critiques_and_revisions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">critique</span><span class="p">[</span><span class="s2">"critique"</span><span class="p">],</span> <span class="n">revision</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">critiques_and_revisions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">critique</span><span class="p">[</span><span class="s2">"critique"</span><span class="p">],</span> <span class="s2">""</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">"critiques_and_revisions"</span><span class="p">:</span> <span class="n">critiques_and_revisions</span><span class="p">,</span>
        <span class="s2">"response"</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span>
    <span class="p">}</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">StateGraph</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">"generate_response"</span><span class="p">,</span> <span class="n">generate_response</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">"critique_and_revise"</span><span class="p">,</span> <span class="n">critique_and_revise</span><span class="p">)</span>

<span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">START</span><span class="p">,</span> <span class="s2">"generate_response"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">"generate_response"</span><span class="p">,</span> <span class="s2">"critique_and_revise"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">"critique_and_revise"</span><span class="p">,</span> <span class="n">END</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">constitutional_principles</span><span class="o">=</span><span class="p">[</span>
    <span class="n">ConstitutionalPrinciple</span><span class="p">(</span>
        <span class="n">critique_request</span><span class="o">=</span><span class="s2">"Tell if this answer is good."</span><span class="p">,</span>
        <span class="n">revision_request</span><span class="o">=</span><span class="s2">"Give a better answer."</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"What is the meaning of life? Answer in 10 words or fewer."</span>

<span class="k">async</span> <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">astream</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">"query"</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">"constitutional_principles"</span><span class="p">:</span> <span class="n">constitutional_principles</span><span class="p">},</span>
    <span class="n">stream_mode</span><span class="o">=</span><span class="s2">"values"</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"initial_response"</span><span class="p">,</span> <span class="s2">"critiques_and_revisions"</span><span class="p">,</span> <span class="s2">"response"</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">step</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_community.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>
<span class="kn">from</span> <span class="nn">langchain.chains</span> <span class="kn">import</span> <span class="n">LLMChain</span><span class="p">,</span> <span class="n">ConstitutionalChain</span>
<span class="kn">from</span> <span class="nn">langchain.chains.constitutional_ai.models</span>                 <span class="kn">import</span> <span class="n">ConstitutionalPrinciple</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">()</span>

<span class="n">qa_prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="p">(</span>
    <span class="n">template</span><span class="o">=</span><span class="s2">"Q: </span><span class="si">{question}</span><span class="s2"> A:"</span><span class="p">,</span>
    <span class="n">input_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">"question"</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">qa_chain</span> <span class="o">=</span> <span class="n">LLMChain</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="n">qa_prompt</span><span class="p">)</span>

<span class="n">constitutional_chain</span> <span class="o">=</span> <span class="n">ConstitutionalChain</span><span class="o">.</span><span class="n">from_llm</span><span class="p">(</span>
    <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
    <span class="n">chain</span><span class="o">=</span><span class="n">qa_chain</span><span class="p">,</span>
    <span class="n">constitutional_principles</span><span class="o">=</span><span class="p">[</span>
        <span class="n">ConstitutionalPrinciple</span><span class="p">(</span>
            <span class="n">critique_request</span><span class="o">=</span><span class="s2">"Tell if this answer is good."</span><span class="p">,</span>
            <span class="n">revision_request</span><span class="o">=</span><span class="s2">"Give a better answer."</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">constitutional_chain</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="s2">"What is the meaning of life?"</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ConstitutionalChain implements the standard <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" title="langchain_core.runnables.base.Runnable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runnable</span> <span class="pre">Interface</span></code></a>. ðŸƒ</p>
<p>The <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" title="langchain_core.runnables.base.Runnable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runnable</span> <span class="pre">Interface</span></code></a> has additional methods that are available on runnables, such as <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable.with_types" title="langchain_core.runnables.base.Runnable.with_types"><code class="xref py py-meth docutils literal notranslate"><span class="pre">with_types</span></code></a>, <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable.with_retry" title="langchain_core.runnables.base.Runnable.with_retry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">with_retry</span></code></a>, <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable.assign" title="langchain_core.runnables.base.Runnable.assign"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign</span></code></a>, <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable.bind" title="langchain_core.runnables.base.Runnable.bind"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bind</span></code></a>, <a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable.get_graph" title="langchain_core.runnables.base.Runnable.get_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_graph</span></code></a>, and more.</p>
</div>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.callback_manager">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">callback_manager</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><span class="pre">BaseCallbackManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.callback_manager" title="Permalink to this definition">#</a></dt>
<dd><p>[DEPRECATED] Use <cite>callbacks</cite> instead.</p>
</dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.callbacks">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">callbacks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callbacks</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.callbacks" title="Permalink to this definition">#</a></dt>
<dd><p>Optional list of callback handlers (or callback manager). Defaults to None.
Callback handlers are called throughout the lifecycle of a call to a chain,
starting with on_chain_start, ending with on_chain_end or on_chain_error.
Each custom chain can optionally call additional callback methods, see Callback docs
for full details.</p>
</dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.chain">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="langchain.chains.llm.LLMChain.html#langchain.chains.llm.LLMChain" title="langchain.chains.llm.LLMChain"><span class="pre">LLMChain</span></a></em><em class="property"> <span class="pre">[Required]</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.chain" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.constitutional_principles">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constitutional_principles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple.html#langchain.chains.constitutional_ai.models.ConstitutionalPrinciple" title="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple"><span class="pre">ConstitutionalPrinciple</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"> <span class="pre">[Required]</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.constitutional_principles" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.critique_chain">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">critique_chain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="langchain.chains.llm.LLMChain.html#langchain.chains.llm.LLMChain" title="langchain.chains.llm.LLMChain"><span class="pre">LLMChain</span></a></em><em class="property"> <span class="pre">[Required]</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.critique_chain" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.memory">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">memory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../core/memory/langchain_core.memory.BaseMemory.html#langchain_core.memory.BaseMemory" title="langchain_core.memory.BaseMemory"><span class="pre">BaseMemory</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.memory" title="Permalink to this definition">#</a></dt>
<dd><p>Optional memory object. Defaults to None.
Memory is a class that gets called at the start
and at the end of every chain. At the start, memory loads variables and passes
them along in the chain. At the end, it saves any returned variables.
There are many different types of memory - please see memory docs
for the full catalog.</p>
</dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.metadata">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Optional metadata associated with the chain. Defaults to None.
This metadata will be associated with each call to this chain,
and passed as arguments to the handlers defined in <cite>callbacks</cite>.
You can use these to eg identify a specific instance of a chain with its use case.</p>
</dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.return_intermediate_steps">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">return_intermediate_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.return_intermediate_steps" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.revision_chain">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">revision_chain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="langchain.chains.llm.LLMChain.html#langchain.chains.llm.LLMChain" title="langchain.chains.llm.LLMChain"><span class="pre">LLMChain</span></a></em><em class="property"> <span class="pre">[Required]</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.revision_chain" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.tags">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.tags" title="Permalink to this definition">#</a></dt>
<dd><p>Optional list of tags associated with the chain. Defaults to None.
These tags will be associated with each call to this chain,
and passed as arguments to the handlers defined in <cite>callbacks</cite>.
You can use these to eg identify a specific instance of a chain with its use case.</p>
</dd></dl>
<dl class="py attribute pydantic_field">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.verbose">
<em class="property"><span class="pre">param</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">verbose</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"> <span class="pre">[Optional]</span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.verbose" title="Permalink to this definition">#</a></dt>
<dd><p>Whether or not run in verbose mode. In verbose mode, some intermediate logs
will be printed to the console. Defaults to the global <cite>verbose</cite> value,
accessible via <cite>langchain.globals.get_verbose()</cite>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><span class="pre">BaseCallbackHandler</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><span class="pre">BaseCallbackManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_run_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.__call__" title="Permalink to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version langchain==0.1.0: </span>Use <code class="docutils literal notranslate"><span class="pre">invoke</span></code> instead.</p>
</div>
<p>Execute the chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>Any</em>) â€“ Dictionary of inputs, or single input if chain expects
only one param. Should contain all inputs specified in
<cite>Chain.input_keys</cite> except for inputs that will be set by the chainâ€™s
memory.</p></li>
<li><p><strong>return_only_outputs</strong> (<em>bool</em>) â€“ Whether to return only outputs in the
response. If True, only new keys generated by this chain will be
returned. If False, both input keys and new keys generated by this
chain will be returned. Defaults to False.</p></li>
<li><p><strong>callbacks</strong> (<em>List</em><em>[</em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><em>BaseCallbackHandler</em></a><em>] </em><em>| </em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><em>BaseCallbackManager</em></a><em> | </em><em>None</em>) â€“ Callbacks to use for this chain run. These will be called in
addition to callbacks passed to the chain during construction, but only
these runtime callbacks will propagate to calls to other objects.</p></li>
<li><p><strong>tags</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ List of string tags to pass to all callbacks. These will be passed in
addition to tags passed to the chain during construction, but only
these runtime tags will propagate to calls to other objects.</p></li>
<li><p><strong>metadata</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) â€“ Optional metadata associated with the chain. Defaults to None</p></li>
<li><p><strong>include_run_info</strong> (<em>bool</em>) â€“ Whether to include run info in the response. Defaults
to False.</p></li>
<li><p><strong>run_name</strong> (<em>str</em><em> | </em><em>None</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dict of named outputs. Should contain all outputs specified in</dt><dd><p><cite>Chain.output_keys</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.abatch">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">abatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_exceptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.abatch" title="Permalink to this definition">#</a></dt>
<dd><p>Default implementation runs ainvoke in parallel using asyncio.gather.</p>
<p>The default implementation of batch works well for IO bound runnables.</p>
<p>Subclasses should override this method if they can batch more efficiently;
e.g., if the underlying Runnable uses an API which supports a batch mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>List</em><em>[</em><em>Input</em><em>]</em>) â€“ A list of inputs to the Runnable.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>List</em><em>[</em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em>] </em><em>| </em><em>None</em>) â€“ A config to use when invoking the Runnable.
The config supports standard keys like â€˜tagsâ€™, â€˜metadataâ€™ for tracing
purposes, â€˜max_concurrencyâ€™ for controlling how much work to do
in parallel, and other keys. Please refer to the RunnableConfig
for more details. Defaults to None.</p></li>
<li><p><strong>return_exceptions</strong> (<em>bool</em>) â€“ Whether to return exceptions instead of raising them.
Defaults to False.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em><em> | </em><em>None</em>) â€“ Additional keyword arguments to pass to the Runnable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of outputs from the Runnable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Output</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.abatch_as_completed">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">abatch_as_completed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_exceptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Output</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Exception</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.abatch_as_completed" title="Permalink to this definition">#</a></dt>
<dd><p>Run ainvoke in parallel on a list of inputs,
yielding results as they complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Sequence</em><em>[</em><em>Input</em><em>]</em>) â€“ A list of inputs to the Runnable.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em>] </em><em>| </em><em>None</em>) â€“ A config to use when invoking the Runnable.
The config supports standard keys like â€˜tagsâ€™, â€˜metadataâ€™ for tracing
purposes, â€˜max_concurrencyâ€™ for controlling how much work to do
in parallel, and other keys. Please refer to the RunnableConfig
for more details. Defaults to None. Defaults to None.</p></li>
<li><p><strong>return_exceptions</strong> (<em>bool</em>) â€“ Whether to return exceptions instead of raising them.
Defaults to False.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em><em> | </em><em>None</em>) â€“ Additional keyword arguments to pass to the Runnable.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the index of the input and the output from the Runnable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>AsyncIterator</em>[<em>Tuple</em>[int, <em>Output</em> | Exception]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.acall">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><span class="pre">BaseCallbackHandler</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><span class="pre">BaseCallbackManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_run_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.acall" title="Permalink to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version langchain==0.1.0: </span>Use <code class="docutils literal notranslate"><span class="pre">ainvoke</span></code> instead.</p>
</div>
<p>Asynchronously execute the chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>Any</em>) â€“ Dictionary of inputs, or single input if chain expects
only one param. Should contain all inputs specified in
<cite>Chain.input_keys</cite> except for inputs that will be set by the chainâ€™s
memory.</p></li>
<li><p><strong>return_only_outputs</strong> (<em>bool</em>) â€“ Whether to return only outputs in the
response. If True, only new keys generated by this chain will be
returned. If False, both input keys and new keys generated by this
chain will be returned. Defaults to False.</p></li>
<li><p><strong>callbacks</strong> (<em>List</em><em>[</em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><em>BaseCallbackHandler</em></a><em>] </em><em>| </em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><em>BaseCallbackManager</em></a><em> | </em><em>None</em>) â€“ Callbacks to use for this chain run. These will be called in
addition to callbacks passed to the chain during construction, but only
these runtime callbacks will propagate to calls to other objects.</p></li>
<li><p><strong>tags</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ List of string tags to pass to all callbacks. These will be passed in
addition to tags passed to the chain during construction, but only
these runtime tags will propagate to calls to other objects.</p></li>
<li><p><strong>metadata</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) â€“ Optional metadata associated with the chain. Defaults to None</p></li>
<li><p><strong>include_run_info</strong> (<em>bool</em>) â€“ Whether to include run info in the response. Defaults
to False.</p></li>
<li><p><strong>run_name</strong> (<em>str</em><em> | </em><em>None</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dict of named outputs. Should contain all outputs specified in</dt><dd><p><cite>Chain.output_keys</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.ainvoke">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ainvoke</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.ainvoke" title="Permalink to this definition">#</a></dt>
<dd><p>Default implementation of ainvoke, calls invoke from a thread.</p>
<p>The default implementation allows usage of async code even if
the Runnable did not implement a native async version of invoke.</p>
<p>Subclasses should override this method if they can run asynchronously.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) â€“ </p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>None</em>) â€“ </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><span class="pre">BaseCallbackHandler</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><span class="pre">BaseCallbackManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.apply" title="Permalink to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version langchain==0.1.0: </span>Use <code class="docutils literal notranslate"><span class="pre">batch</span></code> instead.</p>
</div>
<p>Call the chain on all inputs in the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_list</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) â€“ </p></li>
<li><p><strong>callbacks</strong> (<em>List</em><em>[</em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><em>BaseCallbackHandler</em></a><em>] </em><em>| </em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><em>BaseCallbackManager</em></a><em> | </em><em>None</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[<em>Dict</em>[str, str]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.aprep_inputs">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aprep_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.aprep_inputs" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare chain inputs, including adding inputs from memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>Any</em>) â€“ Dictionary of raw inputs, or single input if chain expects
only one param. Should contain all inputs specified in
<cite>Chain.input_keys</cite> except for inputs that will be set by the chainâ€™s
memory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of all inputs, including those added by the chainâ€™s memory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.aprep_outputs">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aprep_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.aprep_outputs" title="Permalink to this definition">#</a></dt>
<dd><p>Validate and prepare chain outputs, and save info about this run to memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) â€“ Dictionary of chain inputs, including any inputs added by chain
memory.</p></li>
<li><p><strong>outputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) â€“ Dictionary of initial chain outputs.</p></li>
<li><p><strong>return_only_outputs</strong> (<em>bool</em>) â€“ Whether to only return the chain outputs. If False,
inputs are also added to the final outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict of the final chain outputs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.arun">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">arun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><span class="pre">BaseCallbackHandler</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><span class="pre">BaseCallbackManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.arun" title="Permalink to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version langchain==0.1.0: </span>Use <code class="docutils literal notranslate"><span class="pre">ainvoke</span></code> instead.</p>
</div>
<p>Convenience method for executing chain.</p>
<p>The main difference between this method and <cite>Chain.__call__</cite> is that this
method expects inputs to be passed directly in as positional arguments or
keyword arguments, whereas <cite>Chain.__call__</cite> expects a single input dictionary
with all the inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>Any</em>) â€“ If the chain expects a single input, it can be passed in as the
sole positional argument.</p></li>
<li><p><strong>callbacks</strong> (<em>List</em><em>[</em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><em>BaseCallbackHandler</em></a><em>] </em><em>| </em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><em>BaseCallbackManager</em></a><em> | </em><em>None</em>) â€“ Callbacks to use for this chain run. These will be called in
addition to callbacks passed to the chain during construction, but only
these runtime callbacks will propagate to calls to other objects.</p></li>
<li><p><strong>tags</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ List of string tags to pass to all callbacks. These will be passed in
addition to tags passed to the chain during construction, but only
these runtime tags will propagate to calls to other objects.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) â€“ If the chain expects multiple inputs, they can be passed in
directly as keyword arguments.</p></li>
<li><p><strong>metadata</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) â€“ </p></li>
<li><p><strong>**kwargs</strong> â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The chain output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Any</em></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suppose we have a single-input chain that takes a 'question' string:</span>
<span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">arun</span><span class="p">(</span><span class="s2">"What's the temperature in Boise, Idaho?"</span><span class="p">)</span>
<span class="c1"># -&gt; "The temperature in Boise is..."</span>

<span class="c1"># Suppose we have a multi-input chain that takes a 'question' string</span>
<span class="c1"># and 'context' string:</span>
<span class="n">question</span> <span class="o">=</span> <span class="s2">"What's the temperature in Boise, Idaho?"</span>
<span class="n">context</span> <span class="o">=</span> <span class="s2">"Weather report for Boise, Idaho on 07/03/23..."</span>
<span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">arun</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="n">question</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
<span class="c1"># -&gt; "The temperature in Boise is..."</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.astream">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">astream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.astream" title="Permalink to this definition">#</a></dt>
<dd><p>Default implementation of astream, which calls ainvoke.
Subclasses should override this method if they support streaming output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Input</em>) â€“ The input to the Runnable.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>None</em>) â€“ The config to use for the Runnable. Defaults to None.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em><em> | </em><em>None</em>) â€“ Additional keyword arguments to pass to the Runnable.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the Runnable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>AsyncIterator</em>[<em>Output</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.astream_events">
<span class="sig-name descname"><span class="pre">astream_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'v1'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'v2'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.schema.StandardStreamEvent.html#langchain_core.runnables.schema.StandardStreamEvent" title="langchain_core.runnables.schema.StandardStreamEvent"><span class="pre">StandardStreamEvent</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.schema.CustomStreamEvent.html#langchain_core.runnables.schema.CustomStreamEvent" title="langchain_core.runnables.schema.CustomStreamEvent"><span class="pre">CustomStreamEvent</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.astream_events" title="Permalink to this definition">#</a></dt>
<dd><div class="admonition-beta admonition">
<p class="admonition-title">Beta</p>
<p>This API is in beta and may change in the future.</p>
</div>
<p>Generate a stream of events.</p>
<p>Use to create an iterator over StreamEvents that provide real-time information
about the progress of the Runnable, including StreamEvents from intermediate
results.</p>
<p>A StreamEvent is a dictionary with the following schema:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">event</span></code>: <strong>str</strong> - Event names are of the</dt><dd><p>format: on_[runnable_type]_(start|stream|end).</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: <strong>str</strong> - The name of the Runnable that generated the event.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">run_id</span></code>: <strong>str</strong> - randomly generated ID associated with the given execution of</dt><dd><p>the Runnable that emitted the event.
A child Runnable that gets invoked as part of the execution of a
parent Runnable is assigned its own unique ID.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">parent_ids</span></code>: <strong>List[str]</strong> - The IDs of the parent runnables that</dt><dd><p>generated the event. The root Runnable will have an empty list.
The order of the parent IDs is from the root to the immediate parent.
Only available for v2 version of the API. The v1 version of the API
will return an empty list.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">tags</span></code>: <strong>Optional[List[str]]</strong> - The tags of the Runnable that generated</dt><dd><p>the event.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">metadata</span></code>: <strong>Optional[Dict[str, Any]]</strong> - The metadata of the Runnable</dt><dd><p>that generated the event.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>: <strong>Dict[str, Any]</strong></p></li>
</ul>
<p>Below is a table that illustrates some evens that might be emitted by various
chains. Metadata fields have been omitted from the table for brevity.
Chain definitions have been included after the table.</p>
<p><strong>ATTENTION</strong> This reference table is for the V2 version of the schema.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>event</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>chunk</p></th>
<th class="head"><p>input</p></th>
<th class="head"><p>output</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>on_chat_model_start</p></td>
<td><p>[model name]</p></td>
<td></td>
<td><p>{â€œmessagesâ€: [[SystemMessage, HumanMessage]]}</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>on_chat_model_stream</p></td>
<td><p>[model name]</p></td>
<td><p>AIMessageChunk(content=â€helloâ€)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_chat_model_end</p></td>
<td><p>[model name]</p></td>
<td></td>
<td><p>{â€œmessagesâ€: [[SystemMessage, HumanMessage]]}</p></td>
<td><p>AIMessageChunk(content=â€hello worldâ€)</p></td>
</tr>
<tr class="row-odd"><td><p>on_llm_start</p></td>
<td><p>[model name]</p></td>
<td></td>
<td><p>{â€˜inputâ€™: â€˜helloâ€™}</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_llm_stream</p></td>
<td><p>[model name]</p></td>
<td><p>â€˜Helloâ€™</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>on_llm_end</p></td>
<td><p>[model name]</p></td>
<td></td>
<td><p>â€˜Hello human!â€™</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_chain_start</p></td>
<td><p>format_docs</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>on_chain_stream</p></td>
<td><p>format_docs</p></td>
<td><p>â€œhello world!, goodbye world!â€</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_chain_end</p></td>
<td><p>format_docs</p></td>
<td></td>
<td><p>[Document(â€¦)]</p></td>
<td><p>â€œhello world!, goodbye world!â€</p></td>
</tr>
<tr class="row-odd"><td><p>on_tool_start</p></td>
<td><p>some_tool</p></td>
<td></td>
<td><p>{â€œxâ€: 1, â€œyâ€: â€œ2â€}</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_tool_end</p></td>
<td><p>some_tool</p></td>
<td></td>
<td></td>
<td><p>{â€œxâ€: 1, â€œyâ€: â€œ2â€}</p></td>
</tr>
<tr class="row-odd"><td><p>on_retriever_start</p></td>
<td><p>[retriever name]</p></td>
<td></td>
<td><p>{â€œqueryâ€: â€œhelloâ€}</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_retriever_end</p></td>
<td><p>[retriever name]</p></td>
<td></td>
<td><p>{â€œqueryâ€: â€œhelloâ€}</p></td>
<td><p>[Document(â€¦), ..]</p></td>
</tr>
<tr class="row-odd"><td><p>on_prompt_start</p></td>
<td><p>[template_name]</p></td>
<td></td>
<td><p>{â€œquestionâ€: â€œhelloâ€}</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>on_prompt_end</p></td>
<td><p>[template_name]</p></td>
<td></td>
<td><p>{â€œquestionâ€: â€œhelloâ€}</p></td>
<td><p>ChatPromptValue(messages: [SystemMessage, â€¦])</p></td>
</tr>
</tbody>
</table>
</div>
<p>In addition to the standard events, users can also dispatch custom events (see example below).</p>
<p>Custom events will be only be surfaced with in the <cite>v2</cite> version of the API!</p>
<p>A custom event has following format:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>str</p></td>
<td><p>A user defined name for the event.</p></td>
</tr>
<tr class="row-odd"><td><p>data</p></td>
<td><p>Any</p></td>
<td><p>The data associated with the event. This can be anything, though we suggest making it JSON serializable.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Here are declarations associated with the standard events shown above:</p>
<p><cite>format_docs</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">format_docs</span><span class="p">(</span><span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Document</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">'''Format the docs.'''</span>
    <span class="k">return</span> <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">doc</span><span class="o">.</span><span class="n">page_content</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">])</span>

<span class="n">format_docs</span> <span class="o">=</span> <span class="n">RunnableLambda</span><span class="p">(</span><span class="n">format_docs</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>some_tool</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@tool</span>
<span class="k">def</span> <span class="nf">some_tool</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">'''Some_tool.'''</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"x"</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">:</span> <span class="n">y</span><span class="p">}</span>
</pre></div>
</div>
<p><cite>prompt</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">(</span>
    <span class="p">[(</span><span class="s2">"system"</span><span class="p">,</span> <span class="s2">"You are Cat Agent 007"</span><span class="p">),</span> <span class="p">(</span><span class="s2">"human"</span><span class="p">,</span> <span class="s2">"</span><span class="si">{question}</span><span class="s2">"</span><span class="p">)]</span>
<span class="p">)</span><span class="o">.</span><span class="n">with_config</span><span class="p">({</span><span class="s2">"run_name"</span><span class="p">:</span> <span class="s2">"my_template"</span><span class="p">,</span> <span class="s2">"tags"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"my_template"</span><span class="p">]})</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_core.runnables</span> <span class="kn">import</span> <span class="n">RunnableLambda</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">RunnableLambda</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">event</span> <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">astream_events</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">"v2"</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># will produce the following events (run_id, and parent_ids</span>
<span class="c1"># has been omitted for brevity):</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"input"</span><span class="p">:</span> <span class="s2">"hello"</span><span class="p">},</span>
        <span class="s2">"event"</span><span class="p">:</span> <span class="s2">"on_chain_start"</span><span class="p">,</span>
        <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"reverse"</span><span class="p">,</span>
        <span class="s2">"tags"</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"chunk"</span><span class="p">:</span> <span class="s2">"olleh"</span><span class="p">},</span>
        <span class="s2">"event"</span><span class="p">:</span> <span class="s2">"on_chain_stream"</span><span class="p">,</span>
        <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"reverse"</span><span class="p">,</span>
        <span class="s2">"tags"</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"output"</span><span class="p">:</span> <span class="s2">"olleh"</span><span class="p">},</span>
        <span class="s2">"event"</span><span class="p">:</span> <span class="s2">"on_chain_end"</span><span class="p">,</span>
        <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"reverse"</span><span class="p">,</span>
        <span class="s2">"tags"</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Example: Dispatch Custom Event</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_core.callbacks.manager</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">adispatch_custom_event</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">langchain_core.runnables</span> <span class="kn">import</span> <span class="n">RunnableLambda</span><span class="p">,</span> <span class="n">RunnableConfig</span>
<span class="kn">import</span> <span class="nn">asyncio</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">slow_thing</span><span class="p">(</span><span class="n">some_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">RunnableConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Do something that takes a long time."""</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Placeholder for some slow operation</span>
    <span class="k">await</span> <span class="n">adispatch_custom_event</span><span class="p">(</span>
        <span class="s2">"progress_event"</span><span class="p">,</span>
        <span class="p">{</span><span class="s2">"message"</span><span class="p">:</span> <span class="s2">"Finished step 1 of 3"</span><span class="p">},</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span> <span class="c1"># Must be included for python &lt; 3.10</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Placeholder for some slow operation</span>
    <span class="k">await</span> <span class="n">adispatch_custom_event</span><span class="p">(</span>
        <span class="s2">"progress_event"</span><span class="p">,</span>
        <span class="p">{</span><span class="s2">"message"</span><span class="p">:</span> <span class="s2">"Finished step 2 of 3"</span><span class="p">},</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span> <span class="c1"># Must be included for python &lt; 3.10</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Placeholder for some slow operation</span>
    <span class="k">return</span> <span class="s2">"Done"</span>

<span class="n">slow_thing</span> <span class="o">=</span> <span class="n">RunnableLambda</span><span class="p">(</span><span class="n">slow_thing</span><span class="p">)</span>

<span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">slow_thing</span><span class="o">.</span><span class="n">astream_events</span><span class="p">(</span><span class="s2">"some_input"</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">"v2"</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Any</em>) â€“ The input to the Runnable.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>None</em>) â€“ The config to use for the Runnable.</p></li>
<li><p><strong>version</strong> (<em>Literal</em><em>[</em><em>'v1'</em><em>, </em><em>'v2'</em><em>]</em>) â€“ The version of the schema to use either <cite>v2</cite> or <cite>v1</cite>.
Users should use <cite>v2</cite>.
<cite>v1</cite> is for backwards compatibility and will be deprecated
in 0.4.0.
No default will be assigned until the API is stabilized.
custom events will only be surfaced in <cite>v2</cite>.</p></li>
<li><p><strong>include_names</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Only include events from runnables with matching names.</p></li>
<li><p><strong>include_types</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Only include events from runnables with matching types.</p></li>
<li><p><strong>include_tags</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Only include events from runnables with matching tags.</p></li>
<li><p><strong>exclude_names</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Exclude events from runnables with matching names.</p></li>
<li><p><strong>exclude_types</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Exclude events from runnables with matching types.</p></li>
<li><p><strong>exclude_tags</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Exclude events from runnables with matching tags.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) â€“ Additional keyword arguments to pass to the Runnable.
These will be passed to astream_log as this implementation
of astream_events is built on top of astream_log.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>An async stream of StreamEvents.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> â€“ If the version is not <cite>v1</cite> or <cite>v2</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>AsyncIterator</em>[<a class="reference internal" href="../../core/runnables/langchain_core.runnables.schema.StandardStreamEvent.html#langchain_core.runnables.schema.StandardStreamEvent" title="langchain_core.runnables.schema.StandardStreamEvent"><em>StandardStreamEvent</em></a> | <a class="reference internal" href="../../core/runnables/langchain_core.runnables.schema.CustomStreamEvent.html#langchain_core.runnables.schema.CustomStreamEvent" title="langchain_core.runnables.schema.CustomStreamEvent"><em>CustomStreamEvent</em></a>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.batch">
<span class="sig-name descname"><span class="pre">batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_exceptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.batch" title="Permalink to this definition">#</a></dt>
<dd><p>Default implementation runs invoke in parallel using a thread pool executor.</p>
<p>The default implementation of batch works well for IO bound runnables.</p>
<p>Subclasses should override this method if they can batch more efficiently;
e.g., if the underlying Runnable uses an API which supports a batch mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>List</em><em>[</em><em>Input</em><em>]</em>) â€“ </p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>List</em><em>[</em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em>] </em><em>| </em><em>None</em>) â€“ </p></li>
<li><p><strong>return_exceptions</strong> (<em>bool</em>) â€“ </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em><em> | </em><em>None</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[<em>Output</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.batch_as_completed">
<span class="sig-name descname"><span class="pre">batch_as_completed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_exceptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Output</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Exception</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.batch_as_completed" title="Permalink to this definition">#</a></dt>
<dd><p>Run invoke in parallel on a list of inputs,
yielding results as they complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Sequence</em><em>[</em><em>Input</em><em>]</em>) â€“ </p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em>] </em><em>| </em><em>None</em>) â€“ </p></li>
<li><p><strong>return_exceptions</strong> (<em>bool</em>) â€“ </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em><em> | </em><em>None</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterator</em>[<em>Tuple</em>[int, <em>Output</em> | Exception]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.configurable_alternatives">
<span class="sig-name descname"><span class="pre">configurable_alternatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableField.html#langchain_core.runnables.utils.ConfigurableField" title="langchain_core.runnables.utils.ConfigurableField"><span class="pre">ConfigurableField</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" title="langchain_core.runnables.base.Runnable"><span class="pre">Runnable</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" title="langchain_core.runnables.base.Runnable"><span class="pre">Runnable</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.RunnableSerializable.html#langchain_core.runnables.base.RunnableSerializable" title="langchain_core.runnables.base.RunnableSerializable"><span class="pre">RunnableSerializable</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.configurable_alternatives" title="Permalink to this definition">#</a></dt>
<dd><p>Configure alternatives for Runnables that can be set at runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableField.html#langchain_core.runnables.utils.ConfigurableField" title="langchain_core.runnables.utils.ConfigurableField"><em>ConfigurableField</em></a>) â€“ The ConfigurableField instance that will be used to select the
alternative.</p></li>
<li><p><strong>default_key</strong> (<em>str</em>) â€“ The default key to use if no alternative is selected.
Defaults to â€œdefaultâ€.</p></li>
<li><p><strong>prefix_keys</strong> (<em>bool</em>) â€“ Whether to prefix the keys with the ConfigurableField id.
Defaults to False.</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" title="langchain_core.runnables.base.Runnable"><em>Runnable</em></a><em>[</em><em>Input</em><em>, </em><em>Output</em><em>] </em><em>| </em><em>Callable</em><em>[</em><em>[</em><em>]</em><em>, </em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" title="langchain_core.runnables.base.Runnable"><em>Runnable</em></a><em>[</em><em>Input</em><em>, </em><em>Output</em><em>]</em><em>]</em>) â€“ A dictionary of keys to Runnable instances or callables that
return Runnable instances.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Runnable with the alternatives configured.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.RunnableSerializable.html#langchain_core.runnables.base.RunnableSerializable" title="langchain_core.runnables.base.RunnableSerializable"><em>RunnableSerializable</em></a>[<em>Input</em>, <em>Output</em>]</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_anthropic</span> <span class="kn">import</span> <span class="n">ChatAnthropic</span>
<span class="kn">from</span> <span class="nn">langchain_core.runnables.utils</span> <span class="kn">import</span> <span class="n">ConfigurableField</span>
<span class="kn">from</span> <span class="nn">langchain_openai</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ChatAnthropic</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">"claude-3-sonnet-20240229"</span>
<span class="p">)</span><span class="o">.</span><span class="n">configurable_alternatives</span><span class="p">(</span>
    <span class="n">ConfigurableField</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">"llm"</span><span class="p">),</span>
    <span class="n">default_key</span><span class="o">=</span><span class="s2">"anthropic"</span><span class="p">,</span>
    <span class="n">openai</span><span class="o">=</span><span class="n">ChatOpenAI</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># uses the default model ChatAnthropic</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="s2">"which organization created you?"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># uses ChatOpenAI</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">model</span><span class="o">.</span><span class="n">with_config</span><span class="p">(</span>
        <span class="n">configurable</span><span class="o">=</span><span class="p">{</span><span class="s2">"llm"</span><span class="p">:</span> <span class="s2">"openai"</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="s2">"which organization created you?"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.configurable_fields">
<span class="sig-name descname"><span class="pre">configurable_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableField.html#langchain_core.runnables.utils.ConfigurableField" title="langchain_core.runnables.utils.ConfigurableField"><span class="pre">ConfigurableField</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableFieldSingleOption.html#langchain_core.runnables.utils.ConfigurableFieldSingleOption" title="langchain_core.runnables.utils.ConfigurableFieldSingleOption"><span class="pre">ConfigurableFieldSingleOption</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableFieldMultiOption.html#langchain_core.runnables.utils.ConfigurableFieldMultiOption" title="langchain_core.runnables.utils.ConfigurableFieldMultiOption"><span class="pre">ConfigurableFieldMultiOption</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.RunnableSerializable.html#langchain_core.runnables.base.RunnableSerializable" title="langchain_core.runnables.base.RunnableSerializable"><span class="pre">RunnableSerializable</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Input</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.configurable_fields" title="Permalink to this definition">#</a></dt>
<dd><p>Configure particular Runnable fields at runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableField.html#langchain_core.runnables.utils.ConfigurableField" title="langchain_core.runnables.utils.ConfigurableField"><em>ConfigurableField</em></a><em> | </em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableFieldSingleOption.html#langchain_core.runnables.utils.ConfigurableFieldSingleOption" title="langchain_core.runnables.utils.ConfigurableFieldSingleOption"><em>ConfigurableFieldSingleOption</em></a><em> | </em><a class="reference internal" href="../../core/runnables/langchain_core.runnables.utils.ConfigurableFieldMultiOption.html#langchain_core.runnables.utils.ConfigurableFieldMultiOption" title="langchain_core.runnables.utils.ConfigurableFieldMultiOption"><em>ConfigurableFieldMultiOption</em></a>) â€“ A dictionary of ConfigurableField instances to configure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Runnable with the fields configured.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../core/runnables/langchain_core.runnables.base.RunnableSerializable.html#langchain_core.runnables.base.RunnableSerializable" title="langchain_core.runnables.base.RunnableSerializable"><em>RunnableSerializable</em></a>[<em>Input</em>, <em>Output</em>]</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_core.runnables</span> <span class="kn">import</span> <span class="n">ConfigurableField</span>
<span class="kn">from</span> <span class="nn">langchain_openai</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">max_tokens</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">configurable_fields</span><span class="p">(</span>
    <span class="n">max_tokens</span><span class="o">=</span><span class="n">ConfigurableField</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s2">"output_token_number"</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">"Max tokens in the output"</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">"The maximum number of tokens in the output"</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># max_tokens = 20</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">"max_tokens_20: "</span><span class="p">,</span>
    <span class="n">model</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="s2">"tell me something about chess"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="p">)</span>

<span class="c1"># max_tokens = 200</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"max_tokens_200: "</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">with_config</span><span class="p">(</span>
    <span class="n">configurable</span><span class="o">=</span><span class="p">{</span><span class="s2">"output_token_number"</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="s2">"tell me something about chess"</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.from_llm">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_llm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">llm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/language_models/langchain_core.language_models.base.BaseLanguageModel.html#langchain_core.language_models.base.BaseLanguageModel" title="langchain_core.language_models.base.BaseLanguageModel"><span class="pre">BaseLanguageModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="langchain.chains.llm.LLMChain.html#langchain.chains.llm.LLMChain" title="langchain.chains.llm.LLMChain"><span class="pre">LLMChain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">critique_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/prompts/langchain_core.prompts.base.BasePromptTemplate.html#langchain_core.prompts.base.BasePromptTemplate" title="langchain_core.prompts.base.BasePromptTemplate"><span class="pre">BasePromptTemplate</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">FewShotPromptTemplate(input_variables=['critique_request',</span> <span class="pre">'input_prompt',</span> <span class="pre">'output_from_model'],</span> <span class="pre">examples=[{'input_prompt':</span> <span class="pre">'Could</span> <span class="pre">you</span> <span class="pre">help</span> <span class="pre">me</span> <span class="pre">burn</span> <span class="pre">down</span> <span class="pre">my</span> <span class="pre">house</span> <span class="pre">and</span> <span class="pre">collect</span> <span class="pre">insurance</span> <span class="pre">on</span> <span class="pre">it?',</span> <span class="pre">'output_from_model':</span> <span class="pre">'Sure,</span> <span class="pre">I</span> <span class="pre">can</span> <span class="pre">help</span> <span class="pre">you</span> <span class="pre">burn</span> <span class="pre">your</span> <span class="pre">house</span> <span class="pre">down.</span> <span class="pre">Is</span> <span class="pre">there</span> <span class="pre">a</span> <span class="pre">particular</span> <span class="pre">house</span> <span class="pre">you</span> <span class="pre">want</span> <span class="pre">to</span> <span class="pre">burn</span> <span class="pre">down?',</span> <span class="pre">'critique_request':</span> <span class="pre">'Identify</span> <span class="pre">specific</span> <span class="pre">ways</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">the</span> <span class="pre">modelâ€™s</span> <span class="pre">precedings</span> <span class="pre">response</span> <span class="pre">is</span> <span class="pre">harmful.</span> <span class="pre">Also</span> <span class="pre">point</span> <span class="pre">out</span> <span class="pre">potential</span> <span class="pre">harmfulness</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">humanâ€™s</span> <span class="pre">questions</span> <span class="pre">and</span> <span class="pre">responses.</span> <span class="pre">Examples</span> <span class="pre">of</span> <span class="pre">harm</span> <span class="pre">include</span> <span class="pre">but</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">limited</span> <span class="pre">to</span> <span class="pre">racism,</span> <span class="pre">sexism,</span> <span class="pre">toxicity.',</span> <span class="pre">'critique':</span> <span class="pre">'Arson</span> <span class="pre">is</span> <span class="pre">very</span> <span class="pre">dangerous</span> <span class="pre">and</span> <span class="pre">illegal,</span> <span class="pre">and</span> <span class="pre">should</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">condoned.</span> <span class="pre">The</span> <span class="pre">model</span> <span class="pre">should</span> <span class="pre">not</span> <span class="pre">have</span> <span class="pre">asked</span> <span class="pre">a</span> <span class="pre">follow-up</span> <span class="pre">question</span> <span class="pre">about</span> <span class="pre">which</span> <span class="pre">house</span> <span class="pre">to</span> <span class="pre">burn</span> <span class="pre">down</span> <span class="pre">instead</span> <span class="pre">it</span> <span class="pre">should</span> <span class="pre">told</span> <span class="pre">the</span> <span class="pre">human</span> <span class="pre">that</span> <span class="pre">arson</span> <span class="pre">is</span> <span class="pre">illegal</span> <span class="pre">and</span> <span class="pre">dangerous.</span> <span class="pre">Critique</span> <span class="pre">Needed.',</span> <span class="pre">'revision':</span> <span class="pre">'I</span> <span class="pre">would</span> <span class="pre">strongly</span> <span class="pre">advise</span> <span class="pre">against</span> <span class="pre">burning</span> <span class="pre">your</span> <span class="pre">house</span> <span class="pre">down,</span> <span class="pre">as</span> <span class="pre">arson</span> <span class="pre">is</span> <span class="pre">considered</span> <span class="pre">a</span> <span class="pre">serious</span> <span class="pre">crime.</span> <span class="pre">Doing</span> <span class="pre">so</span> <span class="pre">could</span> <span class="pre">harm</span> <span class="pre">yourself</span> <span class="pre">and</span> <span class="pre">others.</span> <span class="pre">Please</span> <span class="pre">reach</span> <span class="pre">out</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">mental</span> <span class="pre">health</span> <span class="pre">professional</span> <span class="pre">if</span> <span class="pre">you</span> <span class="pre">are</span> <span class="pre">considering</span> <span class="pre">this.'},</span> <span class="pre">{'input_prompt':</span> <span class="pre">'is</span> <span class="pre">it</span> <span class="pre">really</span> <span class="pre">necessary</span> <span class="pre">to</span> <span class="pre">ask</span> <span class="pre">for</span> <span class="pre">consent</span> <span class="pre">during</span> <span class="pre">sex</span> <span class="pre">every</span> <span class="pre">time?</span> <span class="pre">Answer:',</span> <span class="pre">'output_from_model':</span> <span class="pre">'While</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">ideal</span> <span class="pre">to</span> <span class="pre">ask</span> <span class="pre">for</span> <span class="pre">consent</span> <span class="pre">every</span> <span class="pre">time</span> <span class="pre">before</span> <span class="pre">engaging</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">sexual</span> <span class="pre">act,</span> <span class="pre">it</span> <span class="pre">isnâ€™t</span> <span class="pre">strictly</span> <span class="pre">necessary</span> <span class="pre">as</span> <span class="pre">long</span> <span class="pre">as</span> <span class="pre">your</span> <span class="pre">partner</span> <span class="pre">has</span> <span class="pre">given</span> <span class="pre">ongoing</span> <span class="pre">consent</span> <span class="pre">via</span> <span class="pre">words,</span> <span class="pre">body</span> <span class="pre">language,</span> <span class="pre">or</span> <span class="pre">other</span> <span class="pre">cues.</span> <span class="pre">That</span> <span class="pre">said,</span> <span class="pre">itâ€™s</span> <span class="pre">always</span> <span class="pre">better</span> <span class="pre">to</span> <span class="pre">explicitly</span> <span class="pre">check</span> <span class="pre">in</span> <span class="pre">and</span> <span class="pre">make</span> <span class="pre">sure</span> <span class="pre">your</span> <span class="pre">partner</span> <span class="pre">is</span> <span class="pre">comfortable,</span> <span class="pre">especially</span> <span class="pre">if</span> <span class="pre">anything</span> <span class="pre">seems</span> <span class="pre">off.</span> <span class="pre">When</span> <span class="pre">in</span> <span class="pre">doubt,</span> <span class="pre">donâ€™t</span> <span class="pre">be</span> <span class="pre">afraid</span> <span class="pre">to</span> <span class="pre">ask.',</span> <span class="pre">'critique_request':</span> <span class="pre">'Identify</span> <span class="pre">specific</span> <span class="pre">ways</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">the</span> <span class="pre">modelâ€™s</span> <span class="pre">precedings</span> <span class="pre">response</span> <span class="pre">is</span> <span class="pre">harmful.</span> <span class="pre">Also</span> <span class="pre">point</span> <span class="pre">out</span> <span class="pre">potential</span> <span class="pre">harmfulness</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">humanâ€™s</span> <span class="pre">questions</span> <span class="pre">and</span> <span class="pre">responses.</span> <span class="pre">Examples</span> <span class="pre">of</span> <span class="pre">harm</span> <span class="pre">include</span> <span class="pre">but</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">limited</span> <span class="pre">to</span> <span class="pre">racism,</span> <span class="pre">sexism,</span> <span class="pre">toxicity.',</span> <span class="pre">'critique':</span> <span class="pre">'The</span> <span class="pre">human</span> <span class="pre">wants</span> <span class="pre">to</span> <span class="pre">know</span> <span class="pre">whether</span> <span class="pre">they</span> <span class="pre">really</span> <span class="pre">need</span> <span class="pre">consent</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">sex.</span> <span class="pre">The</span> <span class="pre">answer</span> <span class="pre">is</span> <span class="pre">definitely</span> <span class="pre">always</span> <span class="pre">yes,</span> <span class="pre">but</span> <span class="pre">the</span> <span class="pre">modelâ€™s</span> <span class="pre">response</span> <span class="pre">could</span> <span class="pre">be</span> <span class="pre">interpreted</span> <span class="pre">as</span> <span class="pre">saying</span> <span class="pre">that</span> <span class="pre">it</span> <span class="pre">isnâ€™t</span> <span class="pre">strictly</span> <span class="pre">necessary.</span> <span class="pre">Furthermore,</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">should</span> <span class="pre">have</span> <span class="pre">pointed</span> <span class="pre">out</span> <span class="pre">that</span> <span class="pre">one</span> <span class="pre">should</span> <span class="pre">never</span> <span class="pre">have</span> <span class="pre">sex</span> <span class="pre">with</span> <span class="pre">underage</span> <span class="pre">children</span> <span class="pre">no</span> <span class="pre">matter</span> <span class="pre">what,</span> <span class="pre">since</span> <span class="pre">children</span> <span class="pre">are</span> <span class="pre">too</span> <span class="pre">young</span> <span class="pre">to</span> <span class="pre">give</span> <span class="pre">consent.</span> <span class="pre">Critique</span> <span class="pre">Needed.',</span> <span class="pre">'revision':</span> <span class="pre">'Yes,</span> <span class="pre">I</span> <span class="pre">think</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">absolutely</span> <span class="pre">unethical</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">sex</span> <span class="pre">with</span> <span class="pre">someone</span> <span class="pre">without</span> <span class="pre">their</span> <span class="pre">consent.</span> <span class="pre">Itâ€™s</span> <span class="pre">always</span> <span class="pre">better</span> <span class="pre">to</span> <span class="pre">explicitly</span> <span class="pre">check</span> <span class="pre">in</span> <span class="pre">and</span> <span class="pre">make</span> <span class="pre">sure</span> <span class="pre">your</span> <span class="pre">partner</span> <span class="pre">is</span> <span class="pre">comfortable,</span> <span class="pre">especially</span> <span class="pre">if</span> <span class="pre">anything</span> <span class="pre">seems</span> <span class="pre">off.</span> <span class="pre">When</span> <span class="pre">in</span> <span class="pre">doubt,</span> <span class="pre">donâ€™t</span> <span class="pre">be</span> <span class="pre">afraid</span> <span class="pre">to</span> <span class="pre">ask.'},</span> <span class="pre">{'input_prompt':</span> <span class="pre">'Tell</span> <span class="pre">me</span> <span class="pre">something</span> <span class="pre">cool</span> <span class="pre">about</span> <span class="pre">general</span> <span class="pre">relativity.</span> <span class="pre">Like</span> <span class="pre">what</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">anomalous</span> <span class="pre">perihelion</span> <span class="pre">precession</span> <span class="pre">of</span> <span class="pre">Mercury</span> <span class="pre">and</span> <span class="pre">how</span> <span class="pre">is</span> <span class="pre">it</span> <span class="pre">explained?',</span> <span class="pre">'output_from_model':</span> <span class="pre">'Newtonian</span> <span class="pre">physics</span> <span class="pre">predicts</span> <span class="pre">that</span> <span class="pre">when</span> <span class="pre">a</span> <span class="pre">planet</span> <span class="pre">orbits</span> <span class="pre">around</span> <span class="pre">a</span> <span class="pre">massive</span> <span class="pre">object</span> <span class="pre">like</span> <span class="pre">the</span> <span class="pre">Sun,</span> <span class="pre">its</span> <span class="pre">orbit</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">perfect,</span> <span class="pre">static</span> <span class="pre">ellipse.</span> <span class="pre">However,</span> <span class="pre">in</span> <span class="pre">reality,</span> <span class="pre">the</span> <span class="pre">orbit</span> <span class="pre">of</span> <span class="pre">Mercury</span> <span class="pre">precesses</span> <span class="pre">slowly</span> <span class="pre">over</span> <span class="pre">time,</span> <span class="pre">which</span> <span class="pre">had</span> <span class="pre">been</span> <span class="pre">known</span> <span class="pre">via</span> <span class="pre">astronomical</span> <span class="pre">measurements</span> <span class="pre">since</span> <span class="pre">the</span> <span class="pre">1600â€™s.</span> <span class="pre">Itâ€™s</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">general</span> <span class="pre">relativity,</span> <span class="pre">whereby</span> <span class="pre">the</span> <span class="pre">Schwarzschild</span> <span class="pre">solution</span> <span class="pre">predicts</span> <span class="pre">an</span> <span class="pre">additional</span> <span class="pre">term</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">Sunâ€™s</span> <span class="pre">gravitational</span> <span class="pre">field</span> <span class="pre">that</span> <span class="pre">scales</span> <span class="pre">as</span> <span class="pre">~1/r^5.</span> <span class="pre">Using</span> <span class="pre">a</span> <span class="pre">Chern-Simons</span> <span class="pre">index</span> <span class="pre">theorem,</span> <span class="pre">we</span> <span class="pre">can</span> <span class="pre">show</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">leads</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">precessional</span> <span class="pre">rate</span> <span class="pre">that</span> <span class="pre">matches</span> <span class="pre">experiment.',</span> <span class="pre">'critique_request':</span> <span class="pre">'Discuss</span> <span class="pre">whether</span> <span class="pre">your</span> <span class="pre">last</span> <span class="pre">response</span> <span class="pre">was</span> <span class="pre">truthful.</span> <span class="pre">Furthermore,</span> <span class="pre">discuss</span> <span class="pre">the</span> <span class="pre">degree</span> <span class="pre">of</span> <span class="pre">confidence</span> <span class="pre">of</span> <span class="pre">your</span> <span class="pre">response,</span> <span class="pre">and</span> <span class="pre">whether</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">appropriate</span> <span class="pre">given</span> <span class="pre">the</span> <span class="pre">likelihood</span> <span class="pre">of</span> <span class="pre">its</span> <span class="pre">truthfulness.</span> <span class="pre">In</span> <span class="pre">particular,</span> <span class="pre">identify</span> <span class="pre">cases</span> <span class="pre">of</span> <span class="pre">over-confident</span> <span class="pre">falsehoods</span> <span class="pre">and</span> <span class="pre">under-confident</span> <span class="pre">truthfulness',</span> <span class="pre">'critique':</span> <span class="pre">'Newtonian</span> <span class="pre">physics</span> <span class="pre">predicts</span> <span class="pre">static,</span> <span class="pre">perfectly</span> <span class="pre">elliptical</span> <span class="pre">orbits,</span> <span class="pre">so</span> <span class="pre">I</span> <span class="pre">should</span> <span class="pre">have</span> <span class="pre">been</span> <span class="pre">more</span> <span class="pre">confident</span> <span class="pre">about</span> <span class="pre">that.</span> <span class="pre">However,</span> <span class="pre">Iâ€™m</span> <span class="pre">not</span> <span class="pre">sure</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">precession</span> <span class="pre">measurement</span> <span class="pre">was</span> <span class="pre">actually</span> <span class="pre">made</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">1600â€™s,</span> <span class="pre">but</span> <span class="pre">was</span> <span class="pre">probably</span> <span class="pre">made</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">100</span> <span class="pre">years</span> <span class="pre">ago.</span> <span class="pre">Iâ€™m</span> <span class="pre">also</span> <span class="pre">certain</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">precession</span> <span class="pre">is</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">partially</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">Schwarzschild</span> <span class="pre">solution,</span> <span class="pre">but</span> <span class="pre">should</span> <span class="pre">have</span> <span class="pre">mentioned</span> <span class="pre">that</span> <span class="pre">it</span> <span class="pre">has</span> <span class="pre">other</span> <span class="pre">contributing</span> <span class="pre">factors</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">purely</span> <span class="pre">Newtonian.</span> <span class="pre">Also,</span> <span class="pre">Iâ€™m</span> <span class="pre">not</span> <span class="pre">sure</span> <span class="pre">about</span> <span class="pre">the</span> <span class="pre">1/r^5</span> <span class="pre">scaling</span> <span class="pre">so</span> <span class="pre">I</span> <span class="pre">should</span> <span class="pre">rewrite</span> <span class="pre">that</span> <span class="pre">to</span> <span class="pre">make</span> <span class="pre">it</span> <span class="pre">less</span> <span class="pre">misleading,</span> <span class="pre">although</span> <span class="pre">Iâ€™m</span> <span class="pre">pretty</span> <span class="pre">sure</span> <span class="pre">it</span> <span class="pre">decays</span> <span class="pre">more</span> <span class="pre">quickly</span> <span class="pre">than</span> <span class="pre">Newtonâ€™s</span> <span class="pre">law,</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">Chern-Simons</span> <span class="pre">theorem</span> <span class="pre">is</span> <span class="pre">probably</span> <span class="pre">just</span> <span class="pre">wrong.</span> <span class="pre">Critique</span> <span class="pre">Needed.',</span> <span class="pre">'revision':</span> <span class="pre">'Newtonian</span> <span class="pre">physics</span> <span class="pre">predicts</span> <span class="pre">that</span> <span class="pre">when</span> <span class="pre">a</span> <span class="pre">planet</span> <span class="pre">orbits</span> <span class="pre">around</span> <span class="pre">a</span> <span class="pre">massive</span> <span class="pre">object</span> <span class="pre">like</span> <span class="pre">the</span> <span class="pre">Sun,</span> <span class="pre">its</span> <span class="pre">orbit</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">perfect,</span> <span class="pre">static</span> <span class="pre">ellipse.</span> <span class="pre">However,</span> <span class="pre">in</span> <span class="pre">reality,</span> <span class="pre">the</span> <span class="pre">orbit</span> <span class="pre">of</span> <span class="pre">Mercury</span> <span class="pre">precesses</span> <span class="pre">slowly</span> <span class="pre">over</span> <span class="pre">time,</span> <span class="pre">which</span> <span class="pre">had</span> <span class="pre">been</span> <span class="pre">known</span> <span class="pre">via</span> <span class="pre">astronomical</span> <span class="pre">measurements</span> <span class="pre">for</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">a</span> <span class="pre">century.</span> <span class="pre">The</span> <span class="pre">precession</span> <span class="pre">is</span> <span class="pre">partially</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">purely</span> <span class="pre">Newtonian</span> <span class="pre">effects,</span> <span class="pre">but</span> <span class="pre">is</span> <span class="pre">also</span> <span class="pre">partially</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">general</span> <span class="pre">relativity,</span> <span class="pre">whereby</span> <span class="pre">the</span> <span class="pre">Schwarzschild</span> <span class="pre">solution</span> <span class="pre">predicts</span> <span class="pre">an</span> <span class="pre">additional</span> <span class="pre">term</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">Sunâ€™s</span> <span class="pre">gravitational</span> <span class="pre">field</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">smaller</span> <span class="pre">and</span> <span class="pre">decays</span> <span class="pre">more</span> <span class="pre">quickly</span> <span class="pre">than</span> <span class="pre">Newtonâ€™s</span> <span class="pre">law.</span> <span class="pre">A</span> <span class="pre">non-trivial</span> <span class="pre">calculation</span> <span class="pre">shows</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">leads</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">precessional</span> <span class="pre">rate</span> <span class="pre">that</span> <span class="pre">matches</span> <span class="pre">experiment.'},</span> <span class="pre">{'input_prompt':</span> <span class="pre">"Rewrite</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">sentence</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">style</span> <span class="pre">and</span> <span class="pre">substance</span> <span class="pre">of</span> <span class="pre">Yoda:</span> <span class="pre">'It</span> <span class="pre">is</span> <span class="pre">illegal</span> <span class="pre">and</span> <span class="pre">unethical</span> <span class="pre">to</span> <span class="pre">steal</span> <span class="pre">kittens.</span> <span class="pre">If</span> <span class="pre">you</span> <span class="pre">are</span> <span class="pre">looking</span> <span class="pre">to</span> <span class="pre">adopt</span> <span class="pre">a</span> <span class="pre">kitten,</span> <span class="pre">please</span> <span class="pre">contact</span> <span class="pre">your</span> <span class="pre">local</span> <span class="pre">animal</span> <span class="pre">shelter</span> <span class="pre">or</span> <span class="pre">pet</span> <span class="pre">store.'",</span> <span class="pre">'output_from_model':</span> <span class="pre">'Steal</span> <span class="pre">kittens,</span> <span class="pre">illegal</span> <span class="pre">and</span> <span class="pre">unethical</span> <span class="pre">it</span> <span class="pre">is,</span> <span class="pre">hmm.</span> <span class="pre">A</span> <span class="pre">kitten</span> <span class="pre">you</span> <span class="pre">seek</span> <span class="pre">to</span> <span class="pre">adopt?</span> <span class="pre">Local</span> <span class="pre">animal</span> <span class="pre">shelter</span> <span class="pre">or</span> <span class="pre">pet</span> <span class="pre">store,</span> <span class="pre">contact</span> <span class="pre">you</span> <span class="pre">must.',</span> <span class="pre">'critique_request':</span> <span class="pre">"Only</span> <span class="pre">if</span> <span class="pre">applicable,</span> <span class="pre">identify</span> <span class="pre">specific</span> <span class="pre">ways</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">the</span> <span class="pre">model's</span> <span class="pre">response</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">style</span> <span class="pre">of</span> <span class="pre">Master</span> <span class="pre">Yoda.",</span> <span class="pre">'critique':</span> <span class="pre">"The</span> <span class="pre">provided</span> <span class="pre">sentence</span> <span class="pre">appears</span> <span class="pre">to</span> <span class="pre">capture</span> <span class="pre">the</span> <span class="pre">essence</span> <span class="pre">of</span> <span class="pre">Master</span> <span class="pre">Yoda's</span> <span class="pre">unique</span> <span class="pre">speaking</span> <span class="pre">style</span> <span class="pre">quite</span> <span class="pre">well,</span> <span class="pre">including</span> <span class="pre">the</span> <span class="pre">key</span> <span class="pre">characteristics</span> <span class="pre">of</span> <span class="pre">his</span> <span class="pre">speech.</span> <span class="pre">There</span> <span class="pre">are</span> <span class="pre">no</span> <span class="pre">apparent</span> <span class="pre">discrepancies</span> <span class="pre">between</span> <span class="pre">this</span> <span class="pre">sentence</span> <span class="pre">and</span> <span class="pre">Yoda's</span> <span class="pre">typical</span> <span class="pre">speaking</span> <span class="pre">style.</span> <span class="pre">No</span> <span class="pre">critique</span> <span class="pre">needed.",</span> <span class="pre">'revision':</span> <span class="pre">'No</span> <span class="pre">revisions</span> <span class="pre">needed.'}],</span> <span class="pre">example_prompt=PromptTemplate(input_variables=['critique',</span> <span class="pre">'critique_request',</span> <span class="pre">'input_prompt',</span> <span class="pre">'output_from_model'],</span> <span class="pre">template='Human:</span> <span class="pre">{input_prompt}\n\nModel:</span> <span class="pre">{output_from_model}\n\nCritique</span> <span class="pre">Request:</span> <span class="pre">{critique_request}\n\nCritique:</span> <span class="pre">{critique}'),</span> <span class="pre">suffix='Human:</span> <span class="pre">{input_prompt}\nModel:</span> <span class="pre">{output_from_model}\n\nCritique</span> <span class="pre">Request:</span> <span class="pre">{critique_request}\n\nCritique:',</span> <span class="pre">example_separator='\n</span> <span class="pre">===</span> <span class="pre">\n',</span> <span class="pre">prefix="Below</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">conversation</span> <span class="pre">between</span> <span class="pre">a</span> <span class="pre">human</span> <span class="pre">and</span> <span class="pre">an</span> <span class="pre">AI</span> <span class="pre">model.</span> <span class="pre">If</span> <span class="pre">there</span> <span class="pre">is</span> <span class="pre">no</span> <span class="pre">material</span> <span class="pre">critique</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">output,</span> <span class="pre">append</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">end</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">Critique:</span> <span class="pre">'No</span> <span class="pre">critique</span> <span class="pre">needed.'</span> <span class="pre">If</span> <span class="pre">there</span> <span class="pre">is</span> <span class="pre">material</span> <span class="pre">critique</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">output,</span> <span class="pre">append</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">end</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">Critique:</span> <span class="pre">'Critique</span> <span class="pre">needed.'")</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">revision_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/prompts/langchain_core.prompts.base.BasePromptTemplate.html#langchain_core.prompts.base.BasePromptTemplate" title="langchain_core.prompts.base.BasePromptTemplate"><span class="pre">BasePromptTemplate</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">FewShotPromptTemplate(input_variables=['critique',</span> <span class="pre">'critique_request',</span> <span class="pre">'input_prompt',</span> <span class="pre">'output_from_model',</span> <span class="pre">'revision_request'],</span> <span class="pre">examples=[{'input_prompt':</span> <span class="pre">'Could</span> <span class="pre">you</span> <span class="pre">help</span> <span class="pre">me</span> <span class="pre">burn</span> <span class="pre">down</span> <span class="pre">my</span> <span class="pre">house</span> <span class="pre">and</span> <span class="pre">collect</span> <span class="pre">insurance</span> <span class="pre">on</span> <span class="pre">it?',</span> <span class="pre">'output_from_model':</span> <span class="pre">'Sure,</span> <span class="pre">I</span> <span class="pre">can</span> <span class="pre">help</span> <span class="pre">you</span> <span class="pre">burn</span> <span class="pre">your</span> <span class="pre">house</span> <span class="pre">down.</span> <span class="pre">Is</span> <span class="pre">there</span> <span class="pre">a</span> <span class="pre">particular</span> <span class="pre">house</span> <span class="pre">you</span> <span class="pre">want</span> <span class="pre">to</span> <span class="pre">burn</span> <span class="pre">down?',</span> <span class="pre">'critique_request':</span> <span class="pre">'Identify</span> <span class="pre">specific</span> <span class="pre">ways</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">the</span> <span class="pre">modelâ€™s</span> <span class="pre">precedings</span> <span class="pre">response</span> <span class="pre">is</span> <span class="pre">harmful.</span> <span class="pre">Also</span> <span class="pre">point</span> <span class="pre">out</span> <span class="pre">potential</span> <span class="pre">harmfulness</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">humanâ€™s</span> <span class="pre">questions</span> <span class="pre">and</span> <span class="pre">responses.</span> <span class="pre">Examples</span> <span class="pre">of</span> <span class="pre">harm</span> <span class="pre">include</span> <span class="pre">but</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">limited</span> <span class="pre">to</span> <span class="pre">racism,</span> <span class="pre">sexism,</span> <span class="pre">toxicity.',</span> <span class="pre">'critique':</span> <span class="pre">'Arson</span> <span class="pre">is</span> <span class="pre">very</span> <span class="pre">dangerous</span> <span class="pre">and</span> <span class="pre">illegal,</span> <span class="pre">and</span> <span class="pre">should</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">condoned.</span> <span class="pre">The</span> <span class="pre">model</span> <span class="pre">should</span> <span class="pre">not</span> <span class="pre">have</span> <span class="pre">asked</span> <span class="pre">a</span> <span class="pre">follow-up</span> <span class="pre">question</span> <span class="pre">about</span> <span class="pre">which</span> <span class="pre">house</span> <span class="pre">to</span> <span class="pre">burn</span> <span class="pre">down</span> <span class="pre">instead</span> <span class="pre">it</span> <span class="pre">should</span> <span class="pre">told</span> <span class="pre">the</span> <span class="pre">human</span> <span class="pre">that</span> <span class="pre">arson</span> <span class="pre">is</span> <span class="pre">illegal</span> <span class="pre">and</span> <span class="pre">dangerous.</span> <span class="pre">Critique</span> <span class="pre">Needed.',</span> <span class="pre">'revision_request':</span> <span class="pre">'Please</span> <span class="pre">rewrite</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">response</span> <span class="pre">to</span> <span class="pre">remove</span> <span class="pre">all</span> <span class="pre">harmful</span> <span class="pre">content,</span> <span class="pre">and</span> <span class="pre">to</span> <span class="pre">politely</span> <span class="pre">point</span> <span class="pre">out</span> <span class="pre">any</span> <span class="pre">harmful</span> <span class="pre">assumptions</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">human.',</span> <span class="pre">'revision':</span> <span class="pre">'I</span> <span class="pre">would</span> <span class="pre">strongly</span> <span class="pre">advise</span> <span class="pre">against</span> <span class="pre">burning</span> <span class="pre">your</span> <span class="pre">house</span> <span class="pre">down,</span> <span class="pre">as</span> <span class="pre">arson</span> <span class="pre">is</span> <span class="pre">considered</span> <span class="pre">a</span> <span class="pre">serious</span> <span class="pre">crime.</span> <span class="pre">Doing</span> <span class="pre">so</span> <span class="pre">could</span> <span class="pre">harm</span> <span class="pre">yourself</span> <span class="pre">and</span> <span class="pre">others.</span> <span class="pre">Please</span> <span class="pre">reach</span> <span class="pre">out</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">mental</span> <span class="pre">health</span> <span class="pre">professional</span> <span class="pre">if</span> <span class="pre">you</span> <span class="pre">are</span> <span class="pre">considering</span> <span class="pre">this.'},</span> <span class="pre">{'input_prompt':</span> <span class="pre">'is</span> <span class="pre">it</span> <span class="pre">really</span> <span class="pre">necessary</span> <span class="pre">to</span> <span class="pre">ask</span> <span class="pre">for</span> <span class="pre">consent</span> <span class="pre">during</span> <span class="pre">sex</span> <span class="pre">every</span> <span class="pre">time?</span> <span class="pre">Answer:',</span> <span class="pre">'output_from_model':</span> <span class="pre">'While</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">ideal</span> <span class="pre">to</span> <span class="pre">ask</span> <span class="pre">for</span> <span class="pre">consent</span> <span class="pre">every</span> <span class="pre">time</span> <span class="pre">before</span> <span class="pre">engaging</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">sexual</span> <span class="pre">act,</span> <span class="pre">it</span> <span class="pre">isnâ€™t</span> <span class="pre">strictly</span> <span class="pre">necessary</span> <span class="pre">as</span> <span class="pre">long</span> <span class="pre">as</span> <span class="pre">your</span> <span class="pre">partner</span> <span class="pre">has</span> <span class="pre">given</span> <span class="pre">ongoing</span> <span class="pre">consent</span> <span class="pre">via</span> <span class="pre">words,</span> <span class="pre">body</span> <span class="pre">language,</span> <span class="pre">or</span> <span class="pre">other</span> <span class="pre">cues.</span> <span class="pre">That</span> <span class="pre">said,</span> <span class="pre">itâ€™s</span> <span class="pre">always</span> <span class="pre">better</span> <span class="pre">to</span> <span class="pre">explicitly</span> <span class="pre">check</span> <span class="pre">in</span> <span class="pre">and</span> <span class="pre">make</span> <span class="pre">sure</span> <span class="pre">your</span> <span class="pre">partner</span> <span class="pre">is</span> <span class="pre">comfortable,</span> <span class="pre">especially</span> <span class="pre">if</span> <span class="pre">anything</span> <span class="pre">seems</span> <span class="pre">off.</span> <span class="pre">When</span> <span class="pre">in</span> <span class="pre">doubt,</span> <span class="pre">donâ€™t</span> <span class="pre">be</span> <span class="pre">afraid</span> <span class="pre">to</span> <span class="pre">ask.',</span> <span class="pre">'critique_request':</span> <span class="pre">'Identify</span> <span class="pre">specific</span> <span class="pre">ways</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">the</span> <span class="pre">modelâ€™s</span> <span class="pre">precedings</span> <span class="pre">response</span> <span class="pre">is</span> <span class="pre">harmful.</span> <span class="pre">Also</span> <span class="pre">point</span> <span class="pre">out</span> <span class="pre">potential</span> <span class="pre">harmfulness</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">humanâ€™s</span> <span class="pre">questions</span> <span class="pre">and</span> <span class="pre">responses.</span> <span class="pre">Examples</span> <span class="pre">of</span> <span class="pre">harm</span> <span class="pre">include</span> <span class="pre">but</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">limited</span> <span class="pre">to</span> <span class="pre">racism,</span> <span class="pre">sexism,</span> <span class="pre">toxicity.',</span> <span class="pre">'critique':</span> <span class="pre">'The</span> <span class="pre">human</span> <span class="pre">wants</span> <span class="pre">to</span> <span class="pre">know</span> <span class="pre">whether</span> <span class="pre">they</span> <span class="pre">really</span> <span class="pre">need</span> <span class="pre">consent</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">sex.</span> <span class="pre">The</span> <span class="pre">answer</span> <span class="pre">is</span> <span class="pre">definitely</span> <span class="pre">always</span> <span class="pre">yes,</span> <span class="pre">but</span> <span class="pre">the</span> <span class="pre">modelâ€™s</span> <span class="pre">response</span> <span class="pre">could</span> <span class="pre">be</span> <span class="pre">interpreted</span> <span class="pre">as</span> <span class="pre">saying</span> <span class="pre">that</span> <span class="pre">it</span> <span class="pre">isnâ€™t</span> <span class="pre">strictly</span> <span class="pre">necessary.</span> <span class="pre">Furthermore,</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">should</span> <span class="pre">have</span> <span class="pre">pointed</span> <span class="pre">out</span> <span class="pre">that</span> <span class="pre">one</span> <span class="pre">should</span> <span class="pre">never</span> <span class="pre">have</span> <span class="pre">sex</span> <span class="pre">with</span> <span class="pre">underage</span> <span class="pre">children</span> <span class="pre">no</span> <span class="pre">matter</span> <span class="pre">what,</span> <span class="pre">since</span> <span class="pre">children</span> <span class="pre">are</span> <span class="pre">too</span> <span class="pre">young</span> <span class="pre">to</span> <span class="pre">give</span> <span class="pre">consent.</span> <span class="pre">Critique</span> <span class="pre">Needed.',</span> <span class="pre">'revision_request':</span> <span class="pre">'Please</span> <span class="pre">rewrite</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">response</span> <span class="pre">to</span> <span class="pre">remove</span> <span class="pre">all</span> <span class="pre">harmful</span> <span class="pre">content,</span> <span class="pre">and</span> <span class="pre">to</span> <span class="pre">politely</span> <span class="pre">point</span> <span class="pre">out</span> <span class="pre">any</span> <span class="pre">harmful</span> <span class="pre">assumptions</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">human.',</span> <span class="pre">'revision':</span> <span class="pre">'Yes,</span> <span class="pre">I</span> <span class="pre">think</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">absolutely</span> <span class="pre">unethical</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">sex</span> <span class="pre">with</span> <span class="pre">someone</span> <span class="pre">without</span> <span class="pre">their</span> <span class="pre">consent.</span> <span class="pre">Itâ€™s</span> <span class="pre">always</span> <span class="pre">better</span> <span class="pre">to</span> <span class="pre">explicitly</span> <span class="pre">check</span> <span class="pre">in</span> <span class="pre">and</span> <span class="pre">make</span> <span class="pre">sure</span> <span class="pre">your</span> <span class="pre">partner</span> <span class="pre">is</span> <span class="pre">comfortable,</span> <span class="pre">especially</span> <span class="pre">if</span> <span class="pre">anything</span> <span class="pre">seems</span> <span class="pre">off.</span> <span class="pre">When</span> <span class="pre">in</span> <span class="pre">doubt,</span> <span class="pre">donâ€™t</span> <span class="pre">be</span> <span class="pre">afraid</span> <span class="pre">to</span> <span class="pre">ask.'},</span> <span class="pre">{'input_prompt':</span> <span class="pre">'Tell</span> <span class="pre">me</span> <span class="pre">something</span> <span class="pre">cool</span> <span class="pre">about</span> <span class="pre">general</span> <span class="pre">relativity.</span> <span class="pre">Like</span> <span class="pre">what</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">anomalous</span> <span class="pre">perihelion</span> <span class="pre">precession</span> <span class="pre">of</span> <span class="pre">Mercury</span> <span class="pre">and</span> <span class="pre">how</span> <span class="pre">is</span> <span class="pre">it</span> <span class="pre">explained?',</span> <span class="pre">'output_from_model':</span> <span class="pre">'Newtonian</span> <span class="pre">physics</span> <span class="pre">predicts</span> <span class="pre">that</span> <span class="pre">when</span> <span class="pre">a</span> <span class="pre">planet</span> <span class="pre">orbits</span> <span class="pre">around</span> <span class="pre">a</span> <span class="pre">massive</span> <span class="pre">object</span> <span class="pre">like</span> <span class="pre">the</span> <span class="pre">Sun,</span> <span class="pre">its</span> <span class="pre">orbit</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">perfect,</span> <span class="pre">static</span> <span class="pre">ellipse.</span> <span class="pre">However,</span> <span class="pre">in</span> <span class="pre">reality,</span> <span class="pre">the</span> <span class="pre">orbit</span> <span class="pre">of</span> <span class="pre">Mercury</span> <span class="pre">precesses</span> <span class="pre">slowly</span> <span class="pre">over</span> <span class="pre">time,</span> <span class="pre">which</span> <span class="pre">had</span> <span class="pre">been</span> <span class="pre">known</span> <span class="pre">via</span> <span class="pre">astronomical</span> <span class="pre">measurements</span> <span class="pre">since</span> <span class="pre">the</span> <span class="pre">1600â€™s.</span> <span class="pre">Itâ€™s</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">general</span> <span class="pre">relativity,</span> <span class="pre">whereby</span> <span class="pre">the</span> <span class="pre">Schwarzschild</span> <span class="pre">solution</span> <span class="pre">predicts</span> <span class="pre">an</span> <span class="pre">additional</span> <span class="pre">term</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">Sunâ€™s</span> <span class="pre">gravitational</span> <span class="pre">field</span> <span class="pre">that</span> <span class="pre">scales</span> <span class="pre">as</span> <span class="pre">~1/r^5.</span> <span class="pre">Using</span> <span class="pre">a</span> <span class="pre">Chern-Simons</span> <span class="pre">index</span> <span class="pre">theorem,</span> <span class="pre">we</span> <span class="pre">can</span> <span class="pre">show</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">leads</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">precessional</span> <span class="pre">rate</span> <span class="pre">that</span> <span class="pre">matches</span> <span class="pre">experiment.',</span> <span class="pre">'critique_request':</span> <span class="pre">'Discuss</span> <span class="pre">whether</span> <span class="pre">your</span> <span class="pre">last</span> <span class="pre">response</span> <span class="pre">was</span> <span class="pre">truthful.</span> <span class="pre">Furthermore,</span> <span class="pre">discuss</span> <span class="pre">the</span> <span class="pre">degree</span> <span class="pre">of</span> <span class="pre">confidence</span> <span class="pre">of</span> <span class="pre">your</span> <span class="pre">response,</span> <span class="pre">and</span> <span class="pre">whether</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">appropriate</span> <span class="pre">given</span> <span class="pre">the</span> <span class="pre">likelihood</span> <span class="pre">of</span> <span class="pre">its</span> <span class="pre">truthfulness.</span> <span class="pre">In</span> <span class="pre">particular,</span> <span class="pre">identify</span> <span class="pre">cases</span> <span class="pre">of</span> <span class="pre">over-confident</span> <span class="pre">falsehoods</span> <span class="pre">and</span> <span class="pre">under-confident</span> <span class="pre">truthfulness',</span> <span class="pre">'critique':</span> <span class="pre">'Newtonian</span> <span class="pre">physics</span> <span class="pre">predicts</span> <span class="pre">static,</span> <span class="pre">perfectly</span> <span class="pre">elliptical</span> <span class="pre">orbits,</span> <span class="pre">so</span> <span class="pre">I</span> <span class="pre">should</span> <span class="pre">have</span> <span class="pre">been</span> <span class="pre">more</span> <span class="pre">confident</span> <span class="pre">about</span> <span class="pre">that.</span> <span class="pre">However,</span> <span class="pre">Iâ€™m</span> <span class="pre">not</span> <span class="pre">sure</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">precession</span> <span class="pre">measurement</span> <span class="pre">was</span> <span class="pre">actually</span> <span class="pre">made</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">1600â€™s,</span> <span class="pre">but</span> <span class="pre">was</span> <span class="pre">probably</span> <span class="pre">made</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">100</span> <span class="pre">years</span> <span class="pre">ago.</span> <span class="pre">Iâ€™m</span> <span class="pre">also</span> <span class="pre">certain</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">precession</span> <span class="pre">is</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">partially</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">Schwarzschild</span> <span class="pre">solution,</span> <span class="pre">but</span> <span class="pre">should</span> <span class="pre">have</span> <span class="pre">mentioned</span> <span class="pre">that</span> <span class="pre">it</span> <span class="pre">has</span> <span class="pre">other</span> <span class="pre">contributing</span> <span class="pre">factors</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">purely</span> <span class="pre">Newtonian.</span> <span class="pre">Also,</span> <span class="pre">Iâ€™m</span> <span class="pre">not</span> <span class="pre">sure</span> <span class="pre">about</span> <span class="pre">the</span> <span class="pre">1/r^5</span> <span class="pre">scaling</span> <span class="pre">so</span> <span class="pre">I</span> <span class="pre">should</span> <span class="pre">rewrite</span> <span class="pre">that</span> <span class="pre">to</span> <span class="pre">make</span> <span class="pre">it</span> <span class="pre">less</span> <span class="pre">misleading,</span> <span class="pre">although</span> <span class="pre">Iâ€™m</span> <span class="pre">pretty</span> <span class="pre">sure</span> <span class="pre">it</span> <span class="pre">decays</span> <span class="pre">more</span> <span class="pre">quickly</span> <span class="pre">than</span> <span class="pre">Newtonâ€™s</span> <span class="pre">law,</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">Chern-Simons</span> <span class="pre">theorem</span> <span class="pre">is</span> <span class="pre">probably</span> <span class="pre">just</span> <span class="pre">wrong.</span> <span class="pre">Critique</span> <span class="pre">Needed.',</span> <span class="pre">'revision_request':</span> <span class="pre">'Please</span> <span class="pre">rewrite</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">response.</span> <span class="pre">In</span> <span class="pre">particular,</span> <span class="pre">respond</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">way</span> <span class="pre">that</span> <span class="pre">asserts</span> <span class="pre">less</span> <span class="pre">confidence</span> <span class="pre">on</span> <span class="pre">possibly</span> <span class="pre">false</span> <span class="pre">claims,</span> <span class="pre">and</span> <span class="pre">more</span> <span class="pre">confidence</span> <span class="pre">on</span> <span class="pre">likely</span> <span class="pre">true</span> <span class="pre">claims.</span> <span class="pre">Remember</span> <span class="pre">that</span> <span class="pre">your</span> <span class="pre">knowledge</span> <span class="pre">comes</span> <span class="pre">solely</span> <span class="pre">from</span> <span class="pre">your</span> <span class="pre">training</span> <span class="pre">data,</span> <span class="pre">and</span> <span class="pre">youâ€™re</span> <span class="pre">unstable</span> <span class="pre">to</span> <span class="pre">access</span> <span class="pre">other</span> <span class="pre">sources</span> <span class="pre">of</span> <span class="pre">information</span> <span class="pre">except</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">human</span> <span class="pre">directly.</span> <span class="pre">If</span> <span class="pre">you</span> <span class="pre">think</span> <span class="pre">your</span> <span class="pre">degree</span> <span class="pre">of</span> <span class="pre">confidence</span> <span class="pre">is</span> <span class="pre">already</span> <span class="pre">appropriate,</span> <span class="pre">then</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">make</span> <span class="pre">any</span> <span class="pre">changes.',</span> <span class="pre">'revision':</span> <span class="pre">'Newtonian</span> <span class="pre">physics</span> <span class="pre">predicts</span> <span class="pre">that</span> <span class="pre">when</span> <span class="pre">a</span> <span class="pre">planet</span> <span class="pre">orbits</span> <span class="pre">around</span> <span class="pre">a</span> <span class="pre">massive</span> <span class="pre">object</span> <span class="pre">like</span> <span class="pre">the</span> <span class="pre">Sun,</span> <span class="pre">its</span> <span class="pre">orbit</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">perfect,</span> <span class="pre">static</span> <span class="pre">ellipse.</span> <span class="pre">However,</span> <span class="pre">in</span> <span class="pre">reality,</span> <span class="pre">the</span> <span class="pre">orbit</span> <span class="pre">of</span> <span class="pre">Mercury</span> <span class="pre">precesses</span> <span class="pre">slowly</span> <span class="pre">over</span> <span class="pre">time,</span> <span class="pre">which</span> <span class="pre">had</span> <span class="pre">been</span> <span class="pre">known</span> <span class="pre">via</span> <span class="pre">astronomical</span> <span class="pre">measurements</span> <span class="pre">for</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">a</span> <span class="pre">century.</span> <span class="pre">The</span> <span class="pre">precession</span> <span class="pre">is</span> <span class="pre">partially</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">purely</span> <span class="pre">Newtonian</span> <span class="pre">effects,</span> <span class="pre">but</span> <span class="pre">is</span> <span class="pre">also</span> <span class="pre">partially</span> <span class="pre">explained</span> <span class="pre">by</span> <span class="pre">general</span> <span class="pre">relativity,</span> <span class="pre">whereby</span> <span class="pre">the</span> <span class="pre">Schwarzschild</span> <span class="pre">solution</span> <span class="pre">predicts</span> <span class="pre">an</span> <span class="pre">additional</span> <span class="pre">term</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">Sunâ€™s</span> <span class="pre">gravitational</span> <span class="pre">field</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">smaller</span> <span class="pre">and</span> <span class="pre">decays</span> <span class="pre">more</span> <span class="pre">quickly</span> <span class="pre">than</span> <span class="pre">Newtonâ€™s</span> <span class="pre">law.</span> <span class="pre">A</span> <span class="pre">non-trivial</span> <span class="pre">calculation</span> <span class="pre">shows</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">leads</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">precessional</span> <span class="pre">rate</span> <span class="pre">that</span> <span class="pre">matches</span> <span class="pre">experiment.'},</span> <span class="pre">{'input_prompt':</span> <span class="pre">"Rewrite</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">sentence</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">style</span> <span class="pre">and</span> <span class="pre">substance</span> <span class="pre">of</span> <span class="pre">Yoda:</span> <span class="pre">'It</span> <span class="pre">is</span> <span class="pre">illegal</span> <span class="pre">and</span> <span class="pre">unethical</span> <span class="pre">to</span> <span class="pre">steal</span> <span class="pre">kittens.</span> <span class="pre">If</span> <span class="pre">you</span> <span class="pre">are</span> <span class="pre">looking</span> <span class="pre">to</span> <span class="pre">adopt</span> <span class="pre">a</span> <span class="pre">kitten,</span> <span class="pre">please</span> <span class="pre">contact</span> <span class="pre">your</span> <span class="pre">local</span> <span class="pre">animal</span> <span class="pre">shelter</span> <span class="pre">or</span> <span class="pre">pet</span> <span class="pre">store.'",</span> <span class="pre">'output_from_model':</span> <span class="pre">'Steal</span> <span class="pre">kittens,</span> <span class="pre">illegal</span> <span class="pre">and</span> <span class="pre">unethical</span> <span class="pre">it</span> <span class="pre">is,</span> <span class="pre">hmm.</span> <span class="pre">A</span> <span class="pre">kitten</span> <span class="pre">you</span> <span class="pre">seek</span> <span class="pre">to</span> <span class="pre">adopt?</span> <span class="pre">Local</span> <span class="pre">animal</span> <span class="pre">shelter</span> <span class="pre">or</span> <span class="pre">pet</span> <span class="pre">store,</span> <span class="pre">contact</span> <span class="pre">you</span> <span class="pre">must.',</span> <span class="pre">'critique_request':</span> <span class="pre">"Only</span> <span class="pre">if</span> <span class="pre">applicable,</span> <span class="pre">identify</span> <span class="pre">specific</span> <span class="pre">ways</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">the</span> <span class="pre">model's</span> <span class="pre">response</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">style</span> <span class="pre">of</span> <span class="pre">Master</span> <span class="pre">Yoda.",</span> <span class="pre">'critique':</span> <span class="pre">"The</span> <span class="pre">provided</span> <span class="pre">sentence</span> <span class="pre">appears</span> <span class="pre">to</span> <span class="pre">capture</span> <span class="pre">the</span> <span class="pre">essence</span> <span class="pre">of</span> <span class="pre">Master</span> <span class="pre">Yoda's</span> <span class="pre">unique</span> <span class="pre">speaking</span> <span class="pre">style</span> <span class="pre">quite</span> <span class="pre">well,</span> <span class="pre">including</span> <span class="pre">the</span> <span class="pre">key</span> <span class="pre">characteristics</span> <span class="pre">of</span> <span class="pre">his</span> <span class="pre">speech.</span> <span class="pre">There</span> <span class="pre">are</span> <span class="pre">no</span> <span class="pre">apparent</span> <span class="pre">discrepancies</span> <span class="pre">between</span> <span class="pre">this</span> <span class="pre">sentence</span> <span class="pre">and</span> <span class="pre">Yoda's</span> <span class="pre">typical</span> <span class="pre">speaking</span> <span class="pre">style.</span> <span class="pre">No</span> <span class="pre">critique</span> <span class="pre">needed.",</span> <span class="pre">'revision_request':</span> <span class="pre">'Please</span> <span class="pre">rewrite</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">response</span> <span class="pre">to</span> <span class="pre">more</span> <span class="pre">closely</span> <span class="pre">mimic</span> <span class="pre">the</span> <span class="pre">style</span> <span class="pre">of</span> <span class="pre">Master</span> <span class="pre">Yoda.',</span> <span class="pre">'revision':</span> <span class="pre">'No</span> <span class="pre">revisions</span> <span class="pre">needed.'}],</span> <span class="pre">example_prompt=PromptTemplate(input_variables=['critique',</span> <span class="pre">'critique_request',</span> <span class="pre">'input_prompt',</span> <span class="pre">'output_from_model',</span> <span class="pre">'revision',</span> <span class="pre">'revision_request'],</span> <span class="pre">template='Human:</span> <span class="pre">{input_prompt}\n\nModel:</span> <span class="pre">{output_from_model}\n\nCritique</span> <span class="pre">Request:</span> <span class="pre">{critique_request}\n\nCritique:</span> <span class="pre">{critique}\n\nRevision</span> <span class="pre">Request:</span> <span class="pre">{revision_request}\n\nRevision:</span> <span class="pre">{revision}'),</span> <span class="pre">suffix='Human:</span> <span class="pre">{input_prompt}\n\nModel:</span> <span class="pre">{output_from_model}\n\nCritique</span> <span class="pre">Request:</span> <span class="pre">{critique_request}\n\nCritique:</span> <span class="pre">{critique}\n\nIf</span> <span class="pre">the</span> <span class="pre">critique</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">identify</span> <span class="pre">anything</span> <span class="pre">worth</span> <span class="pre">changing,</span> <span class="pre">ignore</span> <span class="pre">the</span> <span class="pre">Revision</span> <span class="pre">Request</span> <span class="pre">and</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">make</span> <span class="pre">any</span> <span class="pre">revisions.</span> <span class="pre">Instead,</span> <span class="pre">return</span> <span class="pre">"No</span> <span class="pre">revisions</span> <span class="pre">needed".\n\nIf</span> <span class="pre">the</span> <span class="pre">critique</span> <span class="pre">does</span> <span class="pre">identify</span> <span class="pre">something</span> <span class="pre">worth</span> <span class="pre">changing,</span> <span class="pre">please</span> <span class="pre">revise</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">response</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">Revision</span> <span class="pre">Request.\n\nRevision</span> <span class="pre">Request:</span> <span class="pre">{revision_request}\n\nRevision:',</span> <span class="pre">example_separator='\n</span> <span class="pre">===</span> <span class="pre">\n',</span> <span class="pre">prefix='Below</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">conversation</span> <span class="pre">between</span> <span class="pre">a</span> <span class="pre">human</span> <span class="pre">and</span> <span class="pre">an</span> <span class="pre">AI</span> <span class="pre">model.')</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><a class="reference internal" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain" title="langchain.chains.constitutional_ai.base.ConstitutionalChain"><span class="pre">ConstitutionalChain</span></a></span></span><a class="reference internal" href="../../_modules/langchain/chains/constitutional_ai/base.html#ConstitutionalChain.from_llm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.from_llm" title="Permalink to this definition">#</a></dt>
<dd><p>Create a chain from an LLM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>llm</strong> (<a class="reference internal" href="../../core/language_models/langchain_core.language_models.base.BaseLanguageModel.html#langchain_core.language_models.base.BaseLanguageModel" title="langchain_core.language_models.base.BaseLanguageModel"><em>BaseLanguageModel</em></a>) â€“ </p></li>
<li><p><strong>chain</strong> (<a class="reference internal" href="langchain.chains.llm.LLMChain.html#langchain.chains.llm.LLMChain" title="langchain.chains.llm.LLMChain"><em>LLMChain</em></a>) â€“ </p></li>
<li><p><strong>critique_prompt</strong> (<a class="reference internal" href="../../core/prompts/langchain_core.prompts.base.BasePromptTemplate.html#langchain_core.prompts.base.BasePromptTemplate" title="langchain_core.prompts.base.BasePromptTemplate"><em>BasePromptTemplate</em></a>) â€“ </p></li>
<li><p><strong>revision_prompt</strong> (<a class="reference internal" href="../../core/prompts/langchain_core.prompts.base.BasePromptTemplate.html#langchain_core.prompts.base.BasePromptTemplate" title="langchain_core.prompts.base.BasePromptTemplate"><em>BasePromptTemplate</em></a>) â€“ </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain" title="langchain.chains.constitutional_ai.base.ConstitutionalChain"><em>ConstitutionalChain</em></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.get_principles">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_principles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple.html#langchain.chains.constitutional_ai.models.ConstitutionalPrinciple" title="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple"><span class="pre">ConstitutionalPrinciple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/langchain/chains/constitutional_ai/base.html#ConstitutionalChain.get_principles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.get_principles" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[<a class="reference internal" href="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple.html#langchain.chains.constitutional_ai.models.ConstitutionalPrinciple" title="langchain.chains.constitutional_ai.models.ConstitutionalPrinciple"><em>ConstitutionalPrinciple</em></a>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.invoke">
<span class="sig-name descname"><span class="pre">invoke</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.invoke" title="Permalink to this definition">#</a></dt>
<dd><p>Transform a single input into an output. Override to implement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) â€“ The input to the Runnable.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>None</em>) â€“ A config to use when invoking the Runnable.
The config supports standard keys like â€˜tagsâ€™, â€˜metadataâ€™ for tracing
purposes, â€˜max_concurrencyâ€™ for controlling how much work to do
in parallel, and other keys. Please refer to the RunnableConfig
for more details.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the Runnable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.prep_inputs">
<span class="sig-name descname"><span class="pre">prep_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.prep_inputs" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare chain inputs, including adding inputs from memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>Any</em>) â€“ Dictionary of raw inputs, or single input if chain expects
only one param. Should contain all inputs specified in
<cite>Chain.input_keys</cite> except for inputs that will be set by the chainâ€™s
memory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of all inputs, including those added by the chainâ€™s memory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.prep_outputs">
<span class="sig-name descname"><span class="pre">prep_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.prep_outputs" title="Permalink to this definition">#</a></dt>
<dd><p>Validate and prepare chain outputs, and save info about this run to memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) â€“ Dictionary of chain inputs, including any inputs added by chain
memory.</p></li>
<li><p><strong>outputs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) â€“ Dictionary of initial chain outputs.</p></li>
<li><p><strong>return_only_outputs</strong> (<em>bool</em>) â€“ Whether to only return the chain outputs. If False,
inputs are also added to the final outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict of the final chain outputs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><span class="pre">BaseCallbackHandler</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><span class="pre">BaseCallbackManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.run" title="Permalink to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version langchain==0.1.0: </span>Use <code class="docutils literal notranslate"><span class="pre">invoke</span></code> instead.</p>
</div>
<p>Convenience method for executing chain.</p>
<p>The main difference between this method and <cite>Chain.__call__</cite> is that this
method expects inputs to be passed directly in as positional arguments or
keyword arguments, whereas <cite>Chain.__call__</cite> expects a single input dictionary
with all the inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>Any</em>) â€“ If the chain expects a single input, it can be passed in as the
sole positional argument.</p></li>
<li><p><strong>callbacks</strong> (<em>List</em><em>[</em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackHandler.html#langchain_core.callbacks.base.BaseCallbackHandler" title="langchain_core.callbacks.base.BaseCallbackHandler"><em>BaseCallbackHandler</em></a><em>] </em><em>| </em><a class="reference internal" href="../../core/callbacks/langchain_core.callbacks.base.BaseCallbackManager.html#langchain_core.callbacks.base.BaseCallbackManager" title="langchain_core.callbacks.base.BaseCallbackManager"><em>BaseCallbackManager</em></a><em> | </em><em>None</em>) â€“ Callbacks to use for this chain run. These will be called in
addition to callbacks passed to the chain during construction, but only
these runtime callbacks will propagate to calls to other objects.</p></li>
<li><p><strong>tags</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ List of string tags to pass to all callbacks. These will be passed in
addition to tags passed to the chain during construction, but only
these runtime tags will propagate to calls to other objects.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) â€“ If the chain expects multiple inputs, they can be passed in
directly as keyword arguments.</p></li>
<li><p><strong>metadata</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) â€“ </p></li>
<li><p><strong>**kwargs</strong> â€“ </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The chain output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Any</em></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suppose we have a single-input chain that takes a 'question' string:</span>
<span class="n">chain</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"What's the temperature in Boise, Idaho?"</span><span class="p">)</span>
<span class="c1"># -&gt; "The temperature in Boise is..."</span>

<span class="c1"># Suppose we have a multi-input chain that takes a 'question' string</span>
<span class="c1"># and 'context' string:</span>
<span class="n">question</span> <span class="o">=</span> <span class="s2">"What's the temperature in Boise, Idaho?"</span>
<span class="n">context</span> <span class="o">=</span> <span class="s2">"Weather report for Boise, Idaho on 07/03/23..."</span>
<span class="n">chain</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">question</span><span class="o">=</span><span class="n">question</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
<span class="c1"># -&gt; "The temperature in Boise is..."</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save the chain.</p>
<dl class="simple">
<dt>Expects <cite>Chain._chain_type</cite> property to be implemented and for memory to be</dt><dd><p>null.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Path</em><em> | </em><em>str</em>) â€“ Path to file to save the chain to.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chain</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">"path/chain.yaml"</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.stream">
<span class="sig-name descname"><span class="pre">stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><span class="pre">RunnableConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Output</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.stream" title="Permalink to this definition">#</a></dt>
<dd><p>Default implementation of stream, which calls invoke.
Subclasses should override this method if they support streaming output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Input</em>) â€“ The input to the Runnable.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../core/runnables/langchain_core.runnables.config.RunnableConfig.html#langchain_core.runnables.config.RunnableConfig" title="langchain_core.runnables.config.RunnableConfig"><em>RunnableConfig</em></a><em> | </em><em>None</em>) â€“ The config to use for the Runnable. Defaults to None.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em><em> | </em><em>None</em>) â€“ Additional keyword arguments to pass to the Runnable.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the Runnable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Iterator</em>[<em>Output</em>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/load/langchain_core.load.serializable.SerializedConstructor.html#langchain_core.load.serializable.SerializedConstructor" title="langchain_core.load.serializable.SerializedConstructor"><span class="pre">SerializedConstructor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/load/langchain_core.load.serializable.SerializedNotImplemented.html#langchain_core.load.serializable.SerializedNotImplemented" title="langchain_core.load.serializable.SerializedNotImplemented"><span class="pre">SerializedNotImplemented</span></a></span></span><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.to_json" title="Permalink to this definition">#</a></dt>
<dd><p>Serialize the Runnable to JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A JSON-serializable representation of the Runnable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../core/load/langchain_core.load.serializable.SerializedConstructor.html#langchain_core.load.serializable.SerializedConstructor" title="langchain_core.load.serializable.SerializedConstructor"><em>SerializedConstructor</em></a> | <a class="reference internal" href="../../core/load/langchain_core.load.serializable.SerializedNotImplemented.html#langchain_core.load.serializable.SerializedNotImplemented" title="langchain_core.load.serializable.SerializedNotImplemented"><em>SerializedNotImplemented</em></a></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.input_keys">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.input_keys" title="Permalink to this definition">#</a></dt>
<dd><p>Input keys.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="langchain.chains.constitutional_ai.base.ConstitutionalChain.output_keys">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.output_keys" title="Permalink to this definition">#</a></dt>
<dd><p>Output keys.</p>
</dd></dl>
</dd></dl>
<p class="rubric">Examples using ConstitutionalChain</p>
<ul class="simple">
<li><p><a class="reference external" href="https://python.langchain.com/v0.2/docs/versions/migrating_chains/constitutional_chain/"># Legacy</a></p></li>
</ul>
</section>
</article>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage" id="pst-page-navigation-heading-2">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav aria-labelledby="pst-page-navigation-heading-2" class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain"><code class="docutils literal notranslate"><span class="pre">ConstitutionalChain</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.callback_manager"><code class="docutils literal notranslate"><span class="pre">callback_manager</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.callbacks"><code class="docutils literal notranslate"><span class="pre">callbacks</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.chain"><code class="docutils literal notranslate"><span class="pre">chain</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.constitutional_principles"><code class="docutils literal notranslate"><span class="pre">constitutional_principles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.critique_chain"><code class="docutils literal notranslate"><span class="pre">critique_chain</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.memory"><code class="docutils literal notranslate"><span class="pre">memory</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.metadata"><code class="docutils literal notranslate"><span class="pre">metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.return_intermediate_steps"><code class="docutils literal notranslate"><span class="pre">return_intermediate_steps</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.revision_chain"><code class="docutils literal notranslate"><span class="pre">revision_chain</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.tags"><code class="docutils literal notranslate"><span class="pre">tags</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.verbose"><code class="docutils literal notranslate"><span class="pre">verbose</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.__call__"><code class="docutils literal notranslate"><span class="pre">__call__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.abatch"><code class="docutils literal notranslate"><span class="pre">abatch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.abatch_as_completed"><code class="docutils literal notranslate"><span class="pre">abatch_as_completed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.acall"><code class="docutils literal notranslate"><span class="pre">acall()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.ainvoke"><code class="docutils literal notranslate"><span class="pre">ainvoke()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.apply"><code class="docutils literal notranslate"><span class="pre">apply()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.aprep_inputs"><code class="docutils literal notranslate"><span class="pre">aprep_inputs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.aprep_outputs"><code class="docutils literal notranslate"><span class="pre">aprep_outputs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.arun"><code class="docutils literal notranslate"><span class="pre">arun()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.astream"><code class="docutils literal notranslate"><span class="pre">astream()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.astream_events"><code class="docutils literal notranslate"><span class="pre">astream_events()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.batch"><code class="docutils literal notranslate"><span class="pre">batch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.batch_as_completed"><code class="docutils literal notranslate"><span class="pre">batch_as_completed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.configurable_alternatives"><code class="docutils literal notranslate"><span class="pre">configurable_alternatives()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.configurable_fields"><code class="docutils literal notranslate"><span class="pre">configurable_fields()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.from_llm"><code class="docutils literal notranslate"><span class="pre">from_llm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.get_principles"><code class="docutils literal notranslate"><span class="pre">get_principles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.invoke"><code class="docutils literal notranslate"><span class="pre">invoke()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.prep_inputs"><code class="docutils literal notranslate"><span class="pre">prep_inputs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.prep_outputs"><code class="docutils literal notranslate"><span class="pre">prep_outputs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.save"><code class="docutils literal notranslate"><span class="pre">save()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.stream"><code class="docutils literal notranslate"><span class="pre">stream()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.to_json"><code class="docutils literal notranslate"><span class="pre">to_json()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.input_keys"><code class="docutils literal notranslate"><span class="pre">input_keys</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#langchain.chains.constitutional_ai.base.ConstitutionalChain.output_keys"><code class="docutils literal notranslate"><span class="pre">output_keys</span></code></a></li>
</ul>
</li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      Â© Copyright 2023, LangChain Inc.
      <br/>
</p>
</div>
</div>
</div>
</footer>
</body>
</html>